!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e._=t()}(this,function(){"use strict";function e(e,t,n){for(var i=0,r=e.length;i<r;i++)t.apply(n||e,[e[i],i,e]);return e}function t(t,n,i){var r=v.keys(t);return e(r,function(e,r){n.call(i||t,t[e],e,t)},i||t),t}function n(e){return decodeURIComponent(e.replace(/\+/g," "))}function i(e){return encodeURIComponent(e).replace(" ","%20")}function r(e){return _[e]||e}function o(e){return b[e]||e}function a(e){return"\\"+w[e]}function s(e){var t=document.createElement(e.tagname);return v.foreach(e.attributes,function(e,n){t.setAttribute(n,e)}),e.child?e.child.length||(t.innerHTML=e.content):t.innerHTML=e.content,t}function u(e,t){var n=document.createElement("div").cloneNode();if(n.setAttribute("x-root",""),t.length){for(var i=t[1],r=0,o=i.length;r<o;r++)n.appendChild(s(i[r]));for(var r=2,o=t.length;r<o;r++)for(var a=0,u=t[r].length;a<u;a++){var c=t[r][a],l=s(c);n.querySelector("[x-aim='"+c.parent["@"]+"']").appendChild(l)}v.loop(v.slice(n.querySelectorAll("*")),function(e){e.removeAttribute("x-aim")})}return n}var c="0.1",l=Object.prototype,h=[],f=h.slice,d=h.splice,p=eval,m=function(){return this||p("this")}(),v={};v.extend=function(e){var t=f.call(arguments);if(t.length>1)v.compose(e,t[1],t[2]);else for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);return e},v.define=function(e,t,n){return v.isObject(t)?Object.defineProperties(e,t):Object.defineProperty(e,t,n)},v.isObject=function(e){return"function"==typeof e||"object"==typeof e&&!!e};var g=["Array","Arguments","Boolean","Function","String","Number","Null","Date","RegExp","NodeList","Undefined","HTMLCollection"];g.forEach(function(e,t){v["is"+e]=function(t){return l.toString.call(t)==="[object "+e+"]"}}),v.extend({NULL:function(){},cool:function(e){return e},root:m,broken:{},version:c,foreach:function(n,i,r){if(null!=n){if(v.isArray(n))return e(n,i,r||v);if(v.isObject(n)&&!v.isFunction(n))return t(n,i,r||v)}return n},loop:function(){return this.foreach.apply(this,arguments)},keys:function(e){if(null!==e)return v.isArray(e)?Object.keys(e).map(function(e){return+e}):Object.keys(e)},slice:function(e,t){return null!=e?f.call(e,t):[]},splice:function(e,t,n){return v.isArray(e)?d.call(e,t,n||1):delete e[t],e},pop:function(e){return v.isArray(e)?e.pop():e},shift:function(e){return v.isArray(e)?e.shift():e},push:function(e){return v.isArray(e)&&e.push.apply(e,f.call(arguments,1)),e},unshift:function(e){return v.isArray(e)&&e.unshift.apply(e,f.call(arguments,1)),e},clone:function(e){return v.isArray(e)?f.call(e):v.isObject(e)&&!v.isFunction(e)?JSON.parse(JSON.stringify(e)):e},clonedoom:function(e){if(v.isArray(e)||v.isArguments(e)||v.isNodeList(e)||v.isHTMLCollection(e))return f.call(e);if(v.isObject(e)&&!v.isFunction(e)){var t=function(){};t.prototype=e.constructor.prototype;var n=new t;return v.foreach(e,function(e,t){v.isString(e)||v.isNumber(e)||v.isFunction(e)?n[t]=e:n[t]=v.clonedoom(e)}),n}return e},sort:function(e,t){return v.isArray(e)?e.sort(t):e},unique:function(e){for(var t=0,n=e.length;t<n;t++)if(t!==e.length-1)for(var i=t+1;i<e.length;i++)e[t]===e[i]&&e.splice(i--,1);return e},find:function(){return this.filter.apply(this,arguments)},filter:function(e,t,n){var i=[];return v.foreach(v.clonedoom(e),function(e,i){t.call(this,e,i,this)&&!n&&this.push(e)},i),i},reject:function(e,t){var n=[];return v.foreach(v.clonedoom(e),function(e,n){t.call(this,e,n,this)||this.push(e)},n),n},map:function(e,t){return v.foreach(e,function(e,n){this[n]=t.call(this,e,n,this)},e)},cat:function(e,t){var n=[];if(v.isArray(e))for(var i=0,r=e.length;i<r;i++)t.call(e,e[i],i,e)&&n.push(e.splice(i,1).pop())&&i--;else if(v.isObject(e))for(var i in e)if(e.hasOwnProperty(i)&&t.call(e,e[i],i,e)){var o={};o[i]=e[i],n.push(o),delete e[i]}return n},findindex:function(e,t){var n=[];return v.foreach(e,function(e,n){t.call(this,e,n,this)&&this.push(n)},n),n},hook:function(e,t){var n=f.call(arguments,2),i=v.isFunction(t);return v.map(e,function(e){return(i?t:e[t]).apply(e,n)})},bind:function(e){var t=f.call(arguments,1);return v.foreach(e,function(n,i){this.isFunction(n)&&(e[i]=Function.bind.apply(n,t))}),e},reverse:function(e){return v.isArray(e)?v.slice(e).reverse():e},pluck:function(e,t){var n=[];return v.foreach(e,function(e){for(var n=v.keys(e),i=n.length;i--;)n[i]===t+""&&this.push(e[n[i]])},n),n},groupby:function(e,t){if(v.isArray(e)){var n={},i=v.isFunction(t);return v.foreach(e,function(e){var n=i?t(e):e[t];this[n]?this.hasOwnProperty(n)&&this[n].push(e):this[n]=[e]},n),n}return e},toarray:function(e){for(var t=v.keys(e),n=t.length,i=Array(n),r=0;r<n;r++)i[r]=e[t[r]];return i},forarray:function(e){for(var t=v.keys(e),n=t.length,i=Array(n),r=0;r<n;r++){var o={};o[t[r]]=e[t[r]],i[r]=o}return i},pairs:function(e){for(var t=[],n=v.keys(e),i=0,r=n.length;i<r;i++)t.push([n[i],e[n[i]]]);return t},random:function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},compose:function(e,t,n){return n?v.foreach(t,function(t,i){var r=this.isArray(n)?!this.has(n,i):null==n||i!==n;r&&(e[i]=t)}):v.foreach(t,function(t,n){e[n]=t}),e},has:function(e,t){var n=0;return v.foreach(e,function(e){e===t&&(n=1)}),!!n},not:function(e,t){for(var n=0,i=e.length;n<i;n++)v.isequal(e[n],t)&&v.splice(e,n--);return e},bale:function(e,t,n){return v.isArray(e)&&v.isArray(t)?[].concat(e).concat(t):v.compose(v.clonedoom(e),v.clonedoom(t),n)},shuffle:function(e){for(var t,n=v.isArray(e)?e:v.toarray(e),i=n.length,r=Array(i),o=0;o<i;o++)t=v.random(0,o),t!==o&&(r[o]=r[t]),r[t]=n[o];return r},trim:function(e){return e.replace(/^\s+|\s+$/gm,"")},merge:function(){var e=[],t=f.call(arguments);return v.loop(t,function(t){e=e.concat(t)}),this.unique(e)},partial:function(e){var t=f.call(arguments,1);return function(){for(var n=0,i=t.slice(),r=0,o=i.length;r<o;r++)i[r]===v&&(i[r]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return e.apply(this,i)}},before:function(e,t){var n;return function(){return--e>0?n=t.apply(this,arguments):t=null,n}},part:function(e,t){var n=v.partial(v.before,(parseInt(t)||1)+1);return n(e)},once:function(e){return v.part(e)},isequal:function(e,t,n){if(n||null==e||null==t||v.isFunction(e)||v.isFunction(t)||e===t)return e===t;if(v.typeof(e)!==v.typeof(t))return!1;if(e.toString()===t.toString()){if(v.isArray(e)){if(e.length===t.length){for(var i=e.length;i--;)if(e[i]!==t[i])return!1;return!0}return!1}if(v.isObject(e)){var r=v.keys(e),o=v.keys(t);if(r.length===o.length){for(var i=r.length;i--;)if(e[r[i]]!==t[r[i]])return!1;return!0}return!1}}return!1},typeof:function(e){var t,n=[v.isArray(e),v.isArguments(e),v.isBoolean(e),v.isFunction(e),v.isString(e),v.isNumber(e),v.isNull(e),v.isDate(e),v.isRegExp(e),v.isNodeList(e),v.isUndefined(e),v.isHTMLCollection(e)];return t=v.findindex(n,function(e){return e===!0}).shift(),null==t?"object":g[t].toLowerCase()},requery:function(e){var t={};return v.foreach(e,function(e){t[e.name]=e.value}),t},async:function(e,t){return setTimeout(e,t||0)},combom:function(e,t){for(var n,i=0,r=e.length;i<r;i++)if(t.call(e,e[i],i,e)){n=e[i];break}return n}});var y=/[\t\r\n\f\x20]/g;v.extend({paramparse:function(e){e=(e||"").split("#").shift();var t,i,r=e.indexOf("?"),o=/([^&=]+)=?([^&]*)/g,a={};for(t=r===-1?e:e.substr(r+1);i=o.exec(t);)a[n(i[1])]=n(i[2]);return a},paramstringify:function(e){var t=v.clone(e);for(var n in t)t[n]=i(v.isObject(t[n])||v.isArray(t[n])?JSON.stringify(t[n]):t[n]);var r=JSON.stringify(t);return r.replace(/[\"\{\}]/g,"").replace(/:/g,"=").replace(/,/g,"&").replace(y,"")},stringparse:function(e){return v.isBoolean(e)?e:e+""}});var _={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"$quot;","'":"&#x27;","`":"&#x60"},b={"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#x27;":"'","&#x60;":"`"},N="(.)^",x=/\\|'|\r|\n|\u2028|\u2029/g,w={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};v.doomSetting={escape:"{{-([\\s\\S]+?)}}",interpolate:"{{#([\\s\\S]+?)}}",evaluate:"{{([\\s\\S]+?)}}"};if(v.extend({encodeHTML:function(e){return+e===e?e:e.replace(/[&<">'](?:(amp|lt|quot|gt|#39);)?/g,r)},decodeHTML:function(e){return+e===e?e:e.replace(/&((g|l|quo)t|amp|#39);/g,o)},doom:function(e,t){var n=0,i="_p+='",r=f.call(arguments,2),o=RegExp((this.doomSetting.escape||N)+"|"+(this.doomSetting.interpolate||N)+"|"+(this.doomSetting.evaluate||N)+"|$","g");e.replace(o,function(t,r,o,s,u){return i+=e.slice(n,u).replace(x,a),n=u+t.length,r?i+="'+\n((_t=("+r+"))==null?'':_.encodeHTML(_t))+\n'":o?i+="'+\n((_t=("+o+"))==null?'':_t)+\n'":s&&(i+="';\n"+s+"\n_p+='"),t}),i+="';\n",t||(i="with(_x||{}){\n"+i+"}\n"),i="var _t,_p='';\n"+i+"return _p;\n";try{var s=p("(function("+(t||"_x")+",_"+(r.length?","+r.toString():"")+"){"+i+"})")}catch(e){throw e.res=i,console.error(i),e}return function(e){return s.apply(this,[e,v].concat(f.call(arguments,1)))}}}),v.extend({watch:function(e,t,n){function i(){return a}function r(i){return o=a,a=n.call(e,i,o,t)}var o=e[t],a=o;return delete e[t]&&(Object.defineProperty?Object.defineProperty(e,t,{get:i,set:r,enumerable:!0,configurable:!0}):Object.prototype.__defineGetter__&&Object.prototype.__defineSetter__&&(Object.prototype.__defineGetter__.call(e,t,i),Object.prototype.__defineSetter__.call(e,t,r))),e},unwatch:function(e,t){var n=e[t];return delete e[t],e[t]=n,e}}),v.extend({addEvent:function(e,t,n){return e._events||v.define(e,"_events",{value:{},writable:!0,enumerable:!1,configurable:!0}),e._events[t]||(e._events[t]=[]),v.has(e._events[t],n)||e._events[t].push(n),e},removeEvent:function(e,t,n){if(e._events[t])v.not(e._events[t],n),e._events[t].length&&n||delete e._events[t];else if(!t&&!n)return v.release(e);return e},release:function(e){return delete e._events,e},dispatch:function(e,t,n,i){var r=v.isFunction(n);return e._events&&e._events[t]&&(r?v.foreach(e._events[t],function(t){t===n&&t.apply(e,i||[])}):v.foreach(e._events[t],function(t){t.apply(e,i||[])})),e},trigger:function(){return v.dispatch(arguments)}}),v.root.self){var E=v.root.localStorage;E.getItem("aixcache")||E.setItem("aixcache","{}");var T=/<(\/)?(\w+)\s?([^>]+?)?\>{1}/gi,A=/([^<>\s]+)=[\'\"]?([^>\'\"]+)[\'\"]?\s/gi,k=function(e,t){var n={};return e=" "+(e||"")+" ",e.replace(A,function(e,t,i){return n[t]=i,e}),n["x-aim"]=t,n},S=["input","hr","br","img","area","base","!DOCTYPE","!--"];v.extend({datamime:function(e,t){if(v.isObject(e)&&e["Content-type"])switch(e["Content-type"]||e["Content-Type"]){case"application/json":return JSON.stringify(t||{});default:return v.paramstringify(t||{})}return v.paramstringify(t||{})},strip:function(e,t){var n=v.isString(e)?e.replace(/<script\b[^>]*>(.*?)<\/script>/gim,""):"";return t?n.replace(/[\t\r\n\f]/gm,""):n},domparse:function(e){var t=v.trim(v.strip(e)),n=1,i=1,r=[],o=[],a=1;t.replace(T,function(e,t,s,u,c){var l={};l["@"]=a++;var h;if("/"!==t){h=n++,null==r[h]&&(r[h]=[]);h-i++;v.compose(l,{tagname:s,attributes:k(v.trim(u||""),l["@"]),$ob:c+e.length}),r[h].push(l),v.has(S,s)?(--n,--i,l.$oe=0):o.push(l)}else{h=--n,--i,--a;var f=o.pop();f.$oe=c-f.$ob}return e});for(var s=1,u=r.length;s<u;s++)for(var c=r[s],l=r[s+1],h=r[s-1],f=0,d=c.length;f<d;f++){var p=c[f].$ob,m=c[f].$oe,g=null;c[f].content=v.trim(t.substr(p,m)),l&&(g=this.filter(l,function(e,t){return e.$ob>p&&e.$ob+e.$oe<p+m}),0===g.length&&(g=null)),c[f].child=g,c[f].parent=h?this.combom(h,function(e,t){return p>e.$ob&&p+m<e.$ob+e.$oe}):null}return r},virtualDOM:function(e,t){var n=v.domparse(t||"");return u(e,n)},cookieparse:function(e){var t={},n=e?e.split(";"):[];return v.loop(n,function(e){var n=(e||"").search("=");if(n!==-1){var i=v.trim(e.substr(0,n));i.length&&(t[i]=v.trim(e.substr(n+1)))}}),t},cookie:function(e){var t=v.slice(arguments),n=t.length,i=v.cookieparse(document.cookie);if(n){if(1===n)return i[e];var r=new Date;return r.setDate(r.getDate()+365),this.root.document.cookie=this.trim(t[0]+"="+(t[1]||"")+";expires="+(t[2]||r.toGMTString())+";path="+(t[3]||"/")+";domain="+(t[4]||"")+";"+(t[5]?"secure":""))}return i},aix:function(e){var t=v.compose({url:"",type:"GET",param:v.broken,charset:"utf-8",aysnc:!0,vaild:!0,cache:!1,success:v.NULL,fail:v.NULL,loading:null,loaded:null,header:v.broken,username:null,password:null,timeout:0},e||{});if(t.cache){var n=JSON.parse(E.getItem("aixcache")),i=t.url||v.root.location.href.split("#")[0];if(n[i])return t.success.call(v.root,n[i])}var r=new XMLHttpRequest;if("GET"===t.type.toUpperCase()&&t.param&&(t.url+=(t.url.search(/\?/g)===-1?v.keys(t.param).length?"?":"":"&")+this.paramstringify(t.param),t.param=null),v.isFunction(t.loading)){var o=function(e){t.loading.call(v.root,e)};r.addEventListener("loadstart",function(e){o(e),r.removeEventListener("loadstart",o),o=null})}if(v.isFunction(t.loaded)){var a=function(e){t.loaded.call(v.root,e)};r.addEventListener("loadend",function(e){a(e),r.removeEventListener("loadend",a),a=null})}if(null!=t.username?r.open(t.type,t.url,t.aysnc,t.username,t.password||""):r.open(t.type,t.url,t.aysnc),"POST"===t.type&&t.param&&!t.header["Content-type"]&&r.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset="+t.charset),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Aix-Requested","AixHttpRequest"),v.isObject(t.header)&&t.header!==v.broken){var s=t.header["Content-type"];null!=s&&s.search("charset")===-1&&s.search("json")===-1&&(t.header["Content-type"]+=";charset="+t.charset),v.foreach(t.header,function(e,t){r.setRequestHeader(t,e)})}return r.onreadystatechange=function(e){if(4===r.readyState&&r.responseText){var n=r.status;if(n>=200&&n<300||304===n){if(t.success.call(v.root,r.responseText,r,e),t.cache){var i=JSON.parse(E.getItem("aixcache"));i[t.url||v.root.location.href.split("#")[0]]=r.responseText,E.setItem("aixcache",JSON.stringify(i))}}else t.fail.call(v.root,r,e)}},r.send(t.param?v.isObject(t.param)?v.datamime(t.header,t.param):t.param:null),t.timeout&&v.async(function(){r.abort(),t.fail.call(v.root,r)},1e3*t.timeout||5e3),r},aixp:function(e){var t=v.compose({url:"",param:v.broken,key:"callback",fn:("jsonp"+Math.random()).replace(".",""),timeout:5,success:v.NULL,fail:v.NULL},e||{}),n=t.url+"?"+this.paramstringify(t.param)+(this.keys(t.param).length?"&":"")+t.key+"="+t.fn,i=document.createElement("script");i.src=n,v.root[t.fn]=function(e){clearTimeout(t.timesetup),document.body.removeChild(i),v.root[t.fn]=null,t.success.call(v.root,e)},document.body.append(i),t.timeout&&(t.timesetup=setTimeout(function(){document.body.removeChild(i),v.root[t.fn]=null,t.success.call(v.root)},1e3*t.timeout))}})}var L;v.stack=L=function(e){var t=e||[],n=[];v.foreach(t,function(e){var t=v.isObject(e)?v.toarray(e):e||[],i=v.isFunction(t[0])?t[0]:v.NULL,r=v.isNumber(t[1])?t[1]:0,o=function(e){setTimeout(function(){var t=n.pop(),r=i.call(v.root,e);null!=t&&t.call(v.root,r)},1e3*r)};n.push(o)}),v.define(this,"=",{value:n,writable:!0,enumerable:!1,configurable:!1})},v.extend(L.prototype,{noop:function(){return this["="]=[],this},fire:function(){return this["="].length&&this["="].pop().call(v.root)},add:function(){return this.push.apply(this,arguments)},push:function(){var e=this,t=v.slice(arguments);v.foreach(t,function(t){if(!v.isFunction(t)&&!v.isArray(t))return console.error("add/push arguments error when assign to stack!");var n=v.isArray(t)?t[0]:t,i=v.isArray(t)?t[1]||0:parseFloat(t||0),r=function(t){v.async(function(){var i=e["="].pop(),r=n.call(v.root,t);null!=i&&i.call(v.root,r)},1e3*i)};e["="].push(r)})}});var O;return v.hack=O=function(e,t){var n=this,i=e||[],r=i.length,o=new Array(r),a=[];v.define(this,{complete:{value:t||v.NULL,writable:!0,enumerable:!1,configurable:!1},"-":{value:a,writable:!0,enumerable:!1,configurable:!1}}),v.foreach(i,function(e,t){var i=t,r=v.isObject(e)?v.toarray(e):e||[],s=v.isFunction(r[0])?r[0]:v.NULL,u=v.isNumber(r[1])?r[1]:0,c=function(){v.async(function(){var e=s();o[i]=e||1,v.has(o)||(n.complete.apply(v.root,o),n.noop())},1e3*u)};a.push(c)})},v.extend(O.prototype,{noop:function(){return this["-"]=null,this.complete=null,this},fire:function(){return this["-"].length?v.foreach(this["-"],function(e){return e.call(v.root)}):0}}),v}),function(e,t){"function"==typeof define&&define.amd?define(["_"],t):e.z=t(_)}(this,function(e){"use strict";function t(){w||(w=!0,e.loop(T,function(t,n){t.fn.call(e.root,t.ct)}),T=[])}function n(e){A.length>=k.config.limit&&A.shift(),A.push(e)}function i(e){return e.$el.every(function(e){return document.body.contains(e)||document.contains(e)})}function r(t){t=e.strip(e.trim(t));var n=[],i=!V.test(t),o=!F.test(t);if(i&&o)if(t.search(",")>-1)e.loop(t.split(","),function(e){n=n.concat(r(e))});else{if(S.test(t))return[document.getElementById(t.substr(1))];if(L.test(t))n=document.getElementsByClassName(t.substr(1));else if(O.test(t))n=document.getElementsByTagName(t);else{if(D.test(t)){var a=D.exec(t),s=a[1],u=a[2],c=a[3];return null==s?e.slice(document.getElementsByTagName("*")).filter(function(e){return e.getAttribute(u)===c}):r(s).filter(function(e){return e.getAttribute(u)===c})}if(U.test(t)){var l=document.createElement("i");return l.innerHTML=t,n=e.slice(l.childNodes),n.filter(function(e){return 1===e.nodeType})}n=document.querySelectorAll(t)}}else{if(U.test(t)){var l=document.createElement("i");return l.innerHTML=t,n=e.slice(l.childNodes),n.filter(function(e){return 1===e.nodeType})}n=document.querySelectorAll(t)}return e.slice(n)}function o(e){if(e.search("rgb")!=-1){var t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+u(t[1])+u(t[2])+u(t[3])}return e}function a(e){if(e.search("-")!=-1){for(var t=e.split("-"),n=1,i=t.length;n<i;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1);return t.join("")}return e}function s(t){return e.has(I,a(t))?"":"px"}function u(e){return("0"+parseInt(e).toString(16)).slice(-2)}function c(e){if(null==e)return e;var t=e.nextSibling;return null!=t&&1===t.nodeType?t:c(t)}function l(e,t,n){!function(i){e[t]=e[n],e[n]=i}(e[t])}function h(e){return e._zid||(e._zid=ie++)}function f(e,t,n,i){if(t=d(t),t.ns)var r=p(t.ns);return(re[h(e)]||[]).filter(function(e){return e&&(!t.e||e.e==t.e)&&(!t.ns||r.test(e.ns))&&(!n||h(e.fn)===h(n))&&(!i||e.sel==i)})}function d(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function p(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function m(e,t){return e.del&&!oe&&e.e in ae||!!t}function v(e){return se[e]||oe&&ae[e]||e}function g(t,n,i,r,o,a,s){var u=h(t),c=re[u]||(re[u]=[]);e.loop(n.split(/\s/),function(e){if("ready"==e)return k(i);var n=d(e);n.fn=i,n.sel=o,n.e in se&&(i=function(e){var t=e.relatedTarget;if(!t||t!==this&&!this.contains(t))return n.fn.apply(this,arguments)}),n.del=a;var u=a||i;n.proxy=function(e){if(e=N(e),e.isImmediatePropagationStopped())return!1;e.data=r;var n=u.apply(t,e._args==ee?[e]:[e].concat(e._args));return n===!1&&(e.preventDefault(),e.stopPropagation()),n},n.i=c.length,c.push(n),t.addEventListener(v(n.e),n.proxy,m(n,s))})}function y(t,n,i,r,o){var a=h(t);e.loop((n||"").split(/\s/),function(n){e.loop(f(t,n,i,r),function(e){delete re[a][e.i],t.removeEventListener(v(e.e),e.proxy,m(e,o))})})}function _(){return!0}function b(){return!1}function N(t,n){if(n||!t.isDefaultPrevented){n||(n=t),e.loop(ce,function(e,i){var r=n[i];t[i]=function(){return this[e]=_,r&&r.apply(n,arguments)},t[e]=b});try{t.timeStamp||(t.timeStamp=Date.now())}catch(e){}(n.defaultPrevented!==ee?n.defaultPrevented:"returnValue"in n?n.returnValue===!1:n.getPreventDefault&&n.getPreventDefault())&&(t.isDefaultPrevented=_)}return t}function x(e){var t,n={originalEvent:e};for(t in e)ue.test(t)||e[t]===ee||(n[t]=e[t]);return N(n,e)}var w=!1,E=!1,T=[],A=[],k=function(n,r){if(e.isFunction(n))return w?e.async(function(){n(r)}):(T.push({fn:n,ct:r}),"complete"===document.readyState?e.async(t):E||document.addEventListener("DOMContentLoaded",t,!1),void(E=!0));if(n instanceof j)return n;if(e.isString(n)){var o=e.combom(A,function(e){return e.$indicator===n});if(null!=o&&i(o))return e.clonedoom(o)}return new j(n)};k.config={limit:6,version:e.version};var S=/^#[^\s\=\+\.\#\[\]]+/i,L=/^\.[^\s\=\+\.\#\[\]]+$/i,O=/^[^\[\]\+\-\.#\s\=]+$/i,D=/([^\s]+)?\[([^\s]+)=["']?([^\s'"]+)["']?\]$/i,V=/[\s|\r]+/im,F=/[>|\+|\~]+/im,U=/\<[a-zA-Z][\s\S]*\>/,C=Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||function(t){return null!=this.parentNode&&this!==document&&e.has(this.parentNode.querySelectorAll(t),this)},j=function(t){this.$el=[],null!=t&&(e.isString(t)?(this.$el=r(t),this.$indicator=t):t===document||t===e.root||1===t.nodeType?(this.$el.push(t),this.$indicator=t):e.isArray(t)&&(this.$el=e.find(t,function(e){return 1===e.nodeType}),this.$indicator=Math.random())),this.length=this.$el.length,t&&e.isString(t)&&n(e.clonedoom(this))};k.fn=j.prototype={constructor:j,version:e.version,extend:function(t){e.extend(this,t)}},k.matchz=function(t,n){return null==t?t:!e.isString(n)||C.call(t,n)},k.fn.extend({each:function(t,n){return e.loop(this.$el,t,n||this)},get:function(t){return null!=t?this.$el[+t+(t<0?this.length:0)]:e.slice(this.$el)},at:function(e){return k(this.$el[+e+(e<0?this.length:0)])},first:function(){return this.at(0)},last:function(){return this.at(-1)},add:function(){return this.compose.apply(this,arguments)},compose:function(t){if(null!=t){var n=[];t instanceof j?n=t.$el||[]:e.isString(t)?n=k(t).get():e.isArray(t)?n=t:t.nodeType&&t!==document&&1===t.nodeType&&n.push(t),this.$el=e.unique(this.$el.concat(n)),this.length=this.$el.length}return this},by:function(e){return k(this.get().filter(e))},even:function(){return this.by(function(e,t){return t%2!==0})},odd:function(){return this.by(function(e,t){return t%2===0})},next:function(t){var n=[],i=t?"previousElementSibling":"nextElementSibling";return e.loop(this.get(),function(e){null!=e[i]&&3!==e.nodeType&&8!==e.nodeType&&"SCRIPT"!==e.nodeName&&n.push(e[i])}),k(n)},prev:function(e){return this.next(!e)},find:function(t){var n=[];return e.loop(this.$el,function(i){n=e.slice(i.querySelectorAll(t)).concat(n)}),k(n)},siblings:function(){var t=[],n=this.$el;return e.loop(n,function(n){t=e.slice(n.parentNode.children).concat(t)}),k(e.filter(e.unique(t),function(t){return!e.has(n,t)}))},childrens:function(t){var n=[];return e.loop(this.$el,function(i){n=e.slice(i.children).filter(function(e){return k.matchz(e,t)}).concat(n)}),k(e.unique(n))},parent:function(){var t=[];return e.loop(this.$el,function(e){e.parentNode&&t.push(e.parentNode)}),k(t)},parents:function(t){var n=[];return e.loop(this.$el,function(e){for(var i=[],r=e;r;)r=r.parentNode,k.matchz(r,t)&&i.push(r);n=n.concat(i)}),k(n)}});var $=["checked","disabled","readonly","required","validate"],I=["zIndex","lineHeight"];k.fn.extend({addClass:function(t){return this.each(function(n){var i=n.getAttribute("class");i?(i=i.split(" "),n.setAttribute("class",e.unique(i.concat(t.split(" "))).join(" "))):n.setAttribute("class",e.unique(t.split(" ")).join(" "))})},removeClass:function(t){return this.each(function(n){var i=n.getAttribute("class");i&&(i=i.split(" "),e.foreach(t.split(" "),function(t){e.not(i,t)}),n.setAttribute("class",i.join(" ")))})},toggleClass:function(t){return this.each(function(n){var i=n.getAttribute("class");i?(i=i.split(" "),e.foreach(e.unique(t.split(" ")),function(t){e.has(i,t)?e.not(i,t):i.push(t)}),n.setAttribute("class",i.join(" "))):n.setAttribute("class",t)})},attr:function(){var t=e.slice(arguments);if(t.length){if(1===t.length)return this.get(0).getAttribute(t[0]);this.each(function(e){e.setAttribute(t[0],null!=t[1]?t[1].toString():"")})}return this},removeAttr:function(e){return this.each(function(t){t.removeAttribute(e)})},data:function(){var t=e.slice(arguments);return t[0]?(t[0]="data-"+t[0],this.attr.apply(this,t)):this},prop:function(){var t=e.slice(arguments);return t.length?1===t.length?e[e.has($,t[0])?"isString":"cool"](this.attr(t[0])):t[1]!==!1&&0!==t[1]?this.attr(t[0],e.has($,t[0])?"":t[1]):this.removeAttr(t[0]):this},removeProp:function(e){return this.removeAttr(e)},value:function(t){if(e.slice(arguments).length)return this.each(function(n){var i=n.tagName.toUpperCase();"SELECT"===i?e.foreach(e.slice(n.options),function(e){e.removeAttribute("selected"),(e.getAttribute("value")||e.innerText)===t+""&&e.setAttribute("selected","")}):n.setAttribute("value",t)});var n=this.get(0);return"SELECT"===n.tagName.toUpperCase()?n.options[n.selectedIndex].value||n.innerText:n.value||""},val:function(e){return this.value(e)},text:function(t){var n="";return null!=t?this.each(function(e){e.innerText=t+""}):(this.each(function(t){n+=e.decodeHTML(t.innerText||"")}),n)},fill:function(t){if(null!=t){var n="";return t.nodeType&&1===t.nodeType?n=t.outerHTML:e.isObject(t)&&t instanceof j?t.each(function(e){n+=e.outerHTML}):n=t+"",this.each(function(e){null!=e&&(e.innerHTML=n+"")})}var i=this.get(0);return null!=i.innerHTML?i.innerHTML:""},html:function(){return this.fill.apply(this,arguments)},replacewith:function(e){var t=k(e);return this.each(function(e){t.each(function(t){e.parentNode.insertBefore(t,e)}),e.parentNode.removeChild(e)}),t},insertbefore:function(e){var t=k(e);return this.each(function(e){t.each(function(t){e.parentNode.insertBefore(t,e)})})},insertafter:function(e){var t=k(e);return this.each(function(e){t.each(function(t){var n=c(e);null!=n?e.parentNode.insertBefore(t,n):e.parentNode.appendChild(t)})})},append:function(e){var t=k(e);return this.each(function(e){t.each(function(t){e.appendChild(t)})})},remove:function(){return this.off().each(function(e){e.parentNode.removeChild(e)}),this.$el=[],this.length=0,this},empty:function(){return this.each(function(e){e.innerHTML=""})},offset:function(){var e=0,t=0,n=0,i=0,r=this.get(0);for(n=r.offsetWidth,i=r.offsetHeight;r;)t+=r.offsetLeft,e+=r.offsetTop,r=r.offsetParent;return{top:e,left:t,witdh:n,height:i}},pos:function(){var e=this.get(0);return{top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight}},draw:function(t,n){if(e.isString(t))return null==n?o(window.getComputedStyle(this.get(0),null)[t]):this.each(function(i){i.style[a(t)]=e.isNumber(n)?n+s(t):n||""});if(e.isObject(t))for(var i in t)this.draw(i,t[i]);return this},css:function(){return this.draw.apply(this,arguments)},redraw:function(){return this.removeAttr("style")}});var R,M=function(t){var n=this;e.loop(e.keys(t),function(e){n[e]=t[e]})};M.prototype={toString:function(){return JSON.stringify(this)}};var P=function(e,t){this.oldValue=e,this.newValue=t};P.prototype={contains:function(e){return e.length<this.length&&(e.newValue>=this.newValue&&e.newValue<this.newValue+this.length)},toString:function(){return this.length+" element subset, first mapping: old "+this.oldValue+" â†’ new "+this.newValue}};var q=function(e){var t=[];return"#text"!==e.nodeName&&"#comment"!==e.nodeName&&(t.push(e.nodeName),e.attributes&&(e.attributes.class&&t.push(e.nodeName+"."+e.attributes.class.replace(/ /g,".")),e.attributes.id&&t.push(e.nodeName+"#"+e.attributes.id))),t},H=function(t){var n={},i={};return e.loop(t,function(t){e.loop(q(t),function(e){var t=e in n,r=e in i;t||r?t&&(delete n[e],i[e]=!0):n[e]=!0})}),n},X=function(t,n){var i=H(t),r=H(n),o={};return e.loop(e.keys(i),function(e){r[e]&&(o[e]=!0)}),o},J=function(e){return delete e.outerDone,delete e.innerDone,delete e.valueDone,!e.childNodes||e.childNodes.every(J)},B=function(t,n){var i,r;if(!["nodeName","value","checked","selected","data"].every(function(e){return t[e]===n[e]}))return!1;if(Boolean(t.attributes)!==Boolean(n.attributes))return!1;if(Boolean(t.childNodes)!==Boolean(n.childNodes))return!1;if(t.attributes){if(i=e.keys(t.attributes),r=e.keys(n.attributes),i.length!==r.length)return!1;if(!i.every(function(e){if(t.attributes[e]!==n.attributes[e])return!1}))return!1}if(t.childNodes){if(t.childNodes.length!==n.childNodes.length)return!1;if(!t.childNodes.every(function(e,t){return B(e,n.childNodes[t])}))return!1}return!0},z=function(e,t,n,i,r){var o,a,s;if(!e||!t)return!1;if(e.nodeName!==t.nodeName)return!1;if("#text"===e.nodeName)return!!r||e.data===t.data;if(e.nodeName in n)return!0;if(e.attributes&&t.attributes){if(e.attributes.id&&e.attributes.id===t.attributes.id){var u=e.nodeName+"#"+e.attributes.id;if(u in n)return!0}if(e.attributes.class&&e.attributes.class===t.attributes.class){var c=e.nodeName+"."+e.attributes.class.replace(/ /g,".");if(c in n)return!0}}return!!i||(a=e.childNodes?e.childNodes.slice().reverse():[],s=t.childNodes?t.childNodes.slice().reverse():[],a.length===s.length&&(r?a.every(function(e,t){return e.nodeName===s[t].nodeName}):(o=X(a,s),a.every(function(e,t){return z(e,s[t],o,!0,!0)}))))},G=function(t,n,i,r){var o,a,s=0,u=[],c=Array.apply(null,new Array(t.length+1)).map(function(){return[]}),l=X(t,n),h=t.length===n.length;return h&&t.some(function(e,t){var i=q(e),r=q(n[t]);return i.length!==r.length?(h=!1,!0):(i.some(function(e,t){if(e!==r[t])return h=!1,!0}),!h||void 0)}),e.loop(t,function(t,o){e.loop(n,function(e,n){i[o]||r[n]||!z(t,e,l,h)?c[o+1][n+1]=0:(c[o+1][n+1]=c[o][n]?c[o][n]+1:1,c[o+1][n+1]>=s&&(s=c[o+1][n+1],u=[o+1,n+1]))})}),0!==s&&(o=[u[0]-s,u[1]-s],a=new P(o[0],o[1]),a.length=s,a)},W=function(e,t){return Array.apply(null,new Array(e)).map(function(){return t})},Y=function(t,n,i){var r=t.childNodes?W(t.childNodes.length,!0):[],o=n.childNodes?W(n.childNodes.length,!0):[],a=0;return e.loop(i,function(e){var t,n=e.oldValue+e.length,i=e.newValue+e.length;for(t=e.oldValue;t<n;t+=1)r[t]=a;for(t=e.newValue;t<i;t+=1)o[t]=a;a+=1}),{gaps1:r,gaps2:o}},Z=function(t,n){for(var i=t.childNodes?t.childNodes:[],r=n.childNodes?n.childNodes:[],o=W(i.length,!1),a=W(r.length,!1),s=[],u=!0,c=function(){return arguments[1]},l=function(e){o[u.oldValue+e]=!0,a[u.newValue+e]=!0};u;)u=G(i,r,o,a),u&&(s.push(u),e.loop(Array.apply(null,new Array(u.length)).map(c),l));return s},K=function(){this.list=[]};K.prototype={list:!1,add:function(t){var n=this.list;e.loop(t,function(e){n.push(e)})},forEach:function(t){e.loop(this.list,t)}};var Q=function(e){var t,n={debug:!1,diffcap:10,maxDepth:!1,valueDiffing:!0,textDiff:function(){arguments[0].data=arguments[3]},preVirtualDiffApply:function(){},postVirtualDiffApply:function(){},preDiffApply:function(){},postDiffApply:function(){},filterOuterDiff:null};null==e&&(e={});for(t in n)null==e[t]?this[t]=n[t]:this[t]=e[t]};Q.Diff=M,Q.prototype={diff:function(e,t){var n=this.nodeToObj(e),i=this.nodeToObj(t);return R=0,this.debug&&(this.t1Orig=this.nodeToObj(e),this.t2Orig=this.nodeToObj(t)),this.tracker=new K,this.findDiffs(n,i)},findDiffs:function(e,t){var n;do{if(this.debug&&(R+=1,R>this.diffcap))throw window.diffError=[this.t1Orig,this.t2Orig],new Error("surpassed diffcap:"+JSON.stringify(this.t1Orig)+" -> "+JSON.stringify(this.t2Orig));n=this.findNextDiff(e,t,[]),0===n.length&&(B(e,t)||(J(e),n=this.findNextDiff(e,t,[]))),n.length>0&&(this.tracker.add(n),this.applyVirtual(e,n))}while(n.length>0);return this.tracker.list},findNextDiff:function(e,t,n){var i,r;if(this.maxDepth&&n.length>this.maxDepth)return[];if(!e.outerDone){if(i=this.findOuterDiff(e,t,n),this.filterOuterDiff&&(r=this.filterOuterDiff(e,t,i),r&&(i=r)),i.length>0)return e.outerDone=!0,i;e.outerDone=!0}if(!e.innerDone){if(i=this.findInnerDiff(e,t,n),i.length>0)return i;e.innerDone=!0}if(this.valueDiffing&&!e.valueDone){if(i=this.findValueDiff(e,t,n),i.length>0)return e.valueDone=!0,i;e.valueDone=!0}return[]},findOuterDiff:function(t,n,i){var r,o,a=[];return t.nodeName!==n.nodeName?[new M({action:"replaceElement",oldValue:e.clonedoom(t),newValue:e.clonedoom(n),route:i})]:t.data!==n.data?"#text"===t.nodeName?[new M({action:"modifyTextElement",route:i,oldValue:t.data,newValue:n.data})]:[new M({action:"modifyComment",route:i,oldValue:t.data,newValue:n.data})]:(r=t.attributes?e.keys(t.attributes).sort():[],o=n.attributes?e.keys(n.attributes).sort():[],e.loop(r,function(e){var r=o.indexOf(e);r===-1?a.push(new M({action:"removeAttribute",route:i,name:e,value:t.attributes[e]})):(o.splice(r,1),t.attributes[e]!==n.attributes[e]&&a.push(new M({
action:"modifyAttribute",route:i,name:e,oldValue:t.attributes[e],newValue:n.attributes[e]})))}),e.loop(o,function(e){a.push(new M({action:"addAttribute",route:i,name:e,value:n.attributes[e]}))}),a)},nodeToObj:function(t){var n={},i=this;return n.nodeName=t.nodeName,"#text"===n.nodeName||"#comment"===n.nodeName?n.data=t.data:(t.attributes&&t.attributes.length>0&&(n.attributes={},e.loop(e.slice(t.attributes),function(e){n.attributes[e.name]=e.value})),t.childNodes&&t.childNodes.length>0&&(n.childNodes=[],e.loop(e.slice(t.childNodes),function(e){n.childNodes.push(i.nodeToObj(e))})),this.valueDiffing&&(t.value!==ee&&(n.value=t.value),t.checked!==ee&&(n.checked=t.checked),t.selected!==ee&&(n.selected=t.selected))),n},objToNode:function(t,n){var i,r=this;return"#text"===t.nodeName?i=document.createTextNode(t.data):"#comment"===t.nodeName?i=document.createComment(t.data):("svg"===t.nodeName||n?(i=document.createElementNS("http://www.w3.org/2000/svg",t.nodeName),n=!0):i=document.createElement(t.nodeName),t.attributes&&e.loop(e.keys(t.attributes),function(e){i.setAttribute(e,t.attributes[e])}),t.childNodes&&e.loop(t.childNodes,function(e){i.appendChild(r.objToNode(e,n))}),this.valueDiffing&&(t.value&&(i.value=t.value),t.checked&&(i.checked=t.checked),t.selected&&(i.selected=t.selected))),i},findInnerDiff:function(t,n,i){var r,o,a,s,u,c=t.childNodes&&n.childNodes?Z(t,n):[],l=t.childNodes?t.childNodes:[],h=n.childNodes?n.childNodes:[],f=[],d=0;if(c.length>0&&(f=this.attemptGroupRelocation(t,n,c,i),f.length>0))return f;for(o=Math.max(l.length,h.length),l.length!==h.length&&(r=!0),u=0;u<o;u+=1)a=l[u],s=h[u],r&&(a&&!s?"#text"===a.nodeName?(f.push(new M({action:"removeTextElement",route:i.concat(d),value:a.data})),d-=1):(f.push(new M({action:"removeElement",route:i.concat(d),element:e.clonedoom(a)})),d-=1):s&&!a&&("#text"===s.nodeName?f.push(new M({action:"addTextElement",route:i.concat(d),value:s.data})):f.push(new M({action:"addElement",route:i.concat(d),element:e.clonedoom(s)})))),a&&s&&(f=f.concat(this.findNextDiff(a,s,i.concat(d)))),d+=1;return t.innerDone=!0,f},attemptGroupRelocation:function(t,n,i,r){var o,a,s,u,c,l,h,f,d,p=Y(t,n,i),m=p.gaps1,v=p.gaps2,g=Math.min(m.length,v.length),y=[];for(f=0,h=0;f<g;h+=1,f+=1)if(m[f]===!0)if(u=t.childNodes[h],"#text"===u.nodeName){if("#text"===n.childNodes[f].nodeName&&u.data!==n.childNodes[f].data){for(l=h;t.childNodes.length>l+1&&"#text"===t.childNodes[l+1].nodeName;)if(l+=1,n.childNodes[f].data===t.childNodes[l].data){c=!0;break}if(!c)return y.push(new M({action:"modifyTextElement",route:r.concat(f),oldValue:u.data,newValue:n.childNodes[f].data})),y}y.push(new M({action:"removeTextElement",route:r.concat(f),value:u.data})),m.splice(f,1),g=Math.min(m.length,v.length),f-=1}else y.push(new M({action:"removeElement",route:r.concat(f),element:e.clonedoom(u)})),m.splice(f,1),g=Math.min(m.length,v.length),f-=1;else if(v[f]===!0)u=n.childNodes[f],"#text"===u.nodeName?(y.push(new M({action:"addTextElement",route:r.concat(f),value:u.data})),m.splice(f,0,!0),g=Math.min(m.length,v.length),h-=1):(y.push(new M({action:"addElement",route:r.concat(f),element:e.clonedoom(u)})),m.splice(f,0,!0),g=Math.min(m.length,v.length),h-=1);else if(m[f]!==v[f]){if(y.length>0)return y;if(s=i[m[f]],a=Math.min(s.newValue,t.childNodes.length-s.length),a!==s.oldValue){for(o=!1,d=0;d<s.length;d+=1)z(t.childNodes[a+d],t.childNodes[s.oldValue+d],[],!1,!0)||(o=!0);if(o)return[new M({action:"relocateGroup",groupLength:s.length,from:s.oldValue,to:a,route:r})]}}return y},findValueDiff:function(e,t,n){var i=[];return e.selected!==t.selected&&i.push(new M({action:"modifySelected",oldValue:e.selected,newValue:t.selected,route:n})),(e.value||t.value)&&e.value!==t.value&&"OPTION"!==e.nodeName&&i.push(new M({action:"modifyValue",oldValue:e.value,newValue:t.value,route:n})),e.checked!==t.checked&&i.push(new M({action:"modifyChecked",oldValue:e.checked,newValue:t.checked,route:n})),i},applyVirtual:function(t,n){var i=this;return 0===n.length||(e.loop(n,function(e){i.applyVirtualDiff(t,e)}),!0)},getFromVirtualRoute:function(e,t){var n,i,r=e;for(t=t.slice();t.length>0;){if(!r.childNodes)return!1;i=t.splice(0,1)[0],n=r,r=r.childNodes[i]}return{node:r,parentNode:n,nodeIndex:i}},applyVirtualDiff:function(t,n){var i,r,o,a=this.getFromVirtualRoute(t,n.route),s=a.node,u=a.parentNode,c=a.nodeIndex,l={diff:n,node:s};if(this.preVirtualDiffApply(l))return!0;switch(n.action){case"addAttribute":s.attributes||(s.attributes={}),s.attributes[n.name]=n.value,"checked"===n.name?s.checked=!0:"selected"===n.name?s.selected=!0:"INPUT"===s.nodeName&&"value"===n.name&&(s.value=n.value);break;case"modifyAttribute":s.attributes[n.name]=n.newValue,"INPUT"===s.nodeName&&"value"===n.name&&(s.value=n.value);break;case"removeAttribute":delete s.attributes[n.name],0===e.keys(s.attributes).length&&delete s.attributes,"checked"===n.name?s.checked=!1:"selected"===n.name?delete s.selected:"INPUT"===s.nodeName&&"value"===n.name&&delete s.value;break;case"modifyTextElement":s.data=n.newValue,"TEXTAREA"===u.nodeName&&(u.value=n.newValue);break;case"modifyValue":s.value=n.newValue;break;case"modifyComment":s.data=n.newValue;break;case"modifyChecked":s.checked=n.newValue;break;case"modifySelected":s.selected=n.newValue;break;case"replaceElement":i=e.clonedoom(n.newValue),i.outerDone=!0,i.innerDone=!0,i.valueDone=!0,u.childNodes[c]=i;break;case"relocateGroup":e.loop(s.childNodes.splice(n.from,n.groupLength).reverse(),function(e){s.childNodes.splice(n.to,0,e)});break;case"removeElement":u.childNodes.splice(c,1);break;case"addElement":r=n.route.slice(),o=r.splice(r.length-1,1)[0],s=this.getFromVirtualRoute(t,r).node,i=e.clonedoom(n.element),i.outerDone=!0,i.innerDone=!0,i.valueDone=!0,s.childNodes||(s.childNodes=[]),o>=s.childNodes.length?s.childNodes.push(i):s.childNodes.splice(o,0,i);break;case"removeTextElement":u.childNodes.splice(c,1),"TEXTAREA"===u.nodeName&&delete u.value;break;case"addTextElement":r=n.route.slice(),o=r.splice(r.length-1,1)[0],i={},i.nodeName="#text",i.data=n.value,s=this.getFromVirtualRoute(t,r).node,s.childNodes||(s.childNodes=[]),o>=s.childNodes.length?s.childNodes.push(i):s.childNodes.splice(o,0,i),"TEXTAREA"===s.nodeName&&(s.value=n.newValue);break;default:console.log("unknown action")}l.newNode=i,this.postVirtualDiffApply(l)},apply:function(t,n){var i=this;return 0===n.length||(e.loop(n,function(e){if(!i.applyDiff(t,e))return!1}),!0)},getFromRoute:function(e,t){t=t.slice();for(var n,i=e;t.length>0;){if(!i.childNodes)return!1;n=t.splice(0,1)[0],i=i.childNodes[n]}return i},applyDiff:function(t,n){var i,r,o,a,s=this.getFromRoute(t,n.route),u={diff:n,node:s};if(this.preDiffApply(u))return!0;switch(n.action){case"addAttribute":if(!s||!s.setAttribute)return!1;s.setAttribute(n.name,n.value);break;case"modifyAttribute":if(!s||!s.setAttribute)return!1;s.setAttribute(n.name,n.newValue);break;case"removeAttribute":if(!s||!s.removeAttribute)return!1;s.removeAttribute(n.name);break;case"modifyTextElement":if(!s||3!==s.nodeType)return!1;this.textDiff(s,s.data,n.oldValue,n.newValue);break;case"modifyValue":if(!s||"undefined"==typeof s.value)return!1;s.value=n.newValue;break;case"modifyComment":if(!s||"undefined"==typeof s.data)return!1;this.textDiff(s,s.data,n.oldValue,n.newValue);break;case"modifyChecked":if(!s||"undefined"==typeof s.checked)return!1;s.checked=n.newValue;break;case"modifySelected":if(!s||"undefined"==typeof s.selected)return!1;s.selected=n.newValue;break;case"replaceElement":s.parentNode.replaceChild(this.objToNode(n.newValue,"http://www.w3.org/2000/svg"===s.namespaceURI),s);break;case"relocateGroup":e.loop(Array.apply(null,new Array(n.groupLength)).map(function(){return s.removeChild(s.childNodes[n.from])}),function(e,t){0===t&&(r=s.childNodes[n.to]),s.insertBefore(e,r)});break;case"removeElement":s.parentNode.removeChild(s);break;case"addElement":o=n.route.slice(),a=o.splice(o.length-1,1)[0],s=this.getFromRoute(t,o),s.insertBefore(this.objToNode(n.element,"http://www.w3.org/2000/svg"===s.namespaceURI),s.childNodes[a]);break;case"removeTextElement":if(!s||3!==s.nodeType)return!1;s.parentNode.removeChild(s);break;case"addTextElement":if(o=n.route.slice(),a=o.splice(o.length-1,1)[0],i=document.createTextNode(n.value),s=this.getFromRoute(t,o),!s||!s.childNodes)return!1;s.insertBefore(i,s.childNodes[a]);break;default:console.log("unknown action")}return u.newNode=i,this.postDiffApply(u),!0},undo:function(t,n){n=e.slice(n);var i=this;n.length||(n=[n]),n.reverse(),e.loop(n,function(e){i.undoDiff(t,e)})},undoDiff:function(e,t){switch(t.action){case"addAttribute":t.action="removeAttribute",this.applyDiff(e,t);break;case"modifyAttribute":l(t,"oldValue","newValue"),this.applyDiff(e,t);break;case"removeAttribute":t.action="addAttribute",this.applyDiff(e,t);break;case"modifyTextElement":l(t,"oldValue","newValue"),this.applyDiff(e,t);break;case"modifyValue":l(t,"oldValue","newValue"),this.applyDiff(e,t);break;case"modifyComment":l(t,"oldValue","newValue"),this.applyDiff(e,t);break;case"modifyChecked":l(t,"oldValue","newValue"),this.applyDiff(e,t);break;case"modifySelected":l(t,"oldValue","newValue"),this.applyDiff(e,t);break;case"replaceElement":l(t,"oldValue","newValue"),this.applyDiff(e,t);break;case"relocateGroup":l(t,"from","to"),this.applyDiff(e,t);break;case"removeElement":t.action="addElement",this.applyDiff(e,t);break;case"addElement":t.action="removeElement",this.applyDiff(e,t);break;case"removeTextElement":t.action="addTextElement",this.applyDiff(e,t);break;case"addTextElement":t.action="removeTextElement",this.applyDiff(e,t);break;default:console.log("unknown action")}}};var ee,te=new Q({debug:!0,diffcap:99999}),ne={UIEvent:["focus","blur","focusin","focusout"],MouseEvent:["click","dbclick","mouseup","mousedown","mouseout","mouseover","mouseenter","mouseleave"],KeyboardEvent:["keydown","keypress","keyup"]},ie=1,re={},oe="onfocusin"in window,ae={focus:"focusin",blur:"focusout"},se={mouseenter:"mouseover",mouseleave:"mouseout"},ue=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,ce={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};return k.event={add:g,remove:y},k.proxy=function(t,n){var i=2 in arguments&&slice.call(arguments,2);if(e.isFunction(t)){var r=function(){return t.apply(n,i?i.concat(slice.call(arguments)):arguments)};return r._zid=h(t),r}if(e.isString(n))return i?(i.unshift(t[n],t),k.proxy.apply(null,i)):k.proxy(t[n],t);throw new TypeError("expected function")},k.Event=function(t,n){e.isString(t)||(n=t,t=n.type);var i=document.createEvent(e.has(ne.MouseEvent,t)?"MouseEvent":"Events"),r=!0;if(n)for(var o in n)"bubbles"==o?r=!!n[o]:i[o]=n[o];return i.initEvent(t,r,!0),N(i)},k.fn.extend({bind:function(e,t,n){return this.on(e,t,n)},unbind:function(e,t){return this.off(e,t)},reg:function(){return this.bind.apply(this,arguments)},purge:function(){return this.off.apply(this,arguments)},once:function(e,t,n,i){return this.on(e,t,n,i,1)},one:function(){return this.once.apply(this,arguments)},on:function(t,n,i,r,o){var a,s,u=this;return t&&!e.isString(t)?(e.loop(t,function(e,t){u.on(t,n,i,e,o)}),u):(e.isString(n)||e.isFunction(r)||r===!1||(r=i,i=n,n=ee),r!==ee&&i!==!1||(r=i,i=ee),r===!1&&(r=b),u.each(function(u){o&&(a=function(e){return y(u,e.type,r),r.apply(this,arguments)}),n&&(s=function(t){var i,o;if(e.has(k(t.target).parents().get(),u)&&k.matchz(t.target,n)&&(o=t.target),o&&o!==u)return i=e.extend(x(t),{currentTarget:o,liveFired:u}),(a||r).apply(o,[i].concat(e.slice(arguments,1)))}),g(u,t,r,i,n,s||a)}))},off:function(t,n,i){var r=this;return t&&!isString(t)?(e.loop(t,function(e,t){r.off(t,n,e)}),r):(e.isString(n)||e.isFunction(i)||i===!1||(i=n,n=ee),i===!1&&(i=b),r.each(function(e){y(e,t,i,n)}))},delegate:function(e,t,n){return this.on(t,e,n)},undelegate:function(e,t,n){return this.off(t,e,n)},trigger:function(t,n){return t=e.isString(t)?k.Event(t):N(t),t._args=n,this.each(function(e){t.type in ae&&"function"==typeof e[t.type]?e[t.type]():"dispatchEvent"in e?e.dispatchEvent(t):k(e).triggerHandler(t,n)})},triggerHandler:function(t,n){var i,r;return this.each(function(o){i=x(e.isString(t)?k.Event(t):t),i._args=n,i.target=o,e.loop(f(o,t.type||t),function(e){if(r=e.proxy(i),i.isImmediatePropagationStopped())return!1})}),r},dispatch:function(){return this.trigger.apply(this,arguments)}}),e.loop("focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" "),function(e){k.fn[e]=function(t){return 0 in arguments?this.bind(e,t):this.trigger(e)}}),k.fn.extend({serializeArray:function(){var e=[];this.find("checkbox[checked]:not([disabled]),input:not([disabled]):not([type='submit']):not([type='file']),select:not([disabled]),textarea:not([disabled])").each(function(t){var n=k(t).attr("name"),i=k(t).value();n&&e.push({name:n,value:i||""})});return e},serialize:function(){return e.paramstringify(e.requery(this.serializeArray()))},xRender:function(t){return this.each(function(n){this.apply(n,this.diff(n,e.virtualDOM(n,t.nodeType?t.outerHTML:t||"")))},te)}}),k}),function(e,t){"function"==typeof define&&define.amd?define(["_","z"],t):e.aix=t(_,z)}(this,function(_,$){"use strict";function _genertor_(e){return function(){var t=_.clonedoom(this.data),n=[t].concat(_.slice(arguments));return t=_[e].apply(t,n),_.isequal(t,this.data)||(this.data=t,this.dispatch(e,null,n)),this}}function _genertor_$(e){return function(){var t=_.clonedoom(this.data),n=[t].concat(_.slice(arguments));return _[e].apply(t,n)}}function _genertor__(e){return function(){var t=_.clonedoom(this.data),n=[t].concat(_.slice(arguments)),i=_[e].apply(t,n);return _.isequal(t,this.data)||(this.data=t,this.dispatch(e,null,n)),i}}function hackaix(e,t){var n=e.toString(),i=e.toString().replace(strip_comment,""),r=t.toString().replace(strip_comment,""),o=n.slice(n.indexOf("{")+1,n.lastIndexOf("}"));return i=i.slice(i.indexOf("(")+1,i.indexOf(")")).match(/([^\s,]+)/g)[0],r=r.slice(r.indexOf("(")+1,r.indexOf(")")).match(/([^\s,]+)/g)[0],[i||"",r||"",o]}function createExtend(origin){return function(def){var x=hackaix(aix[origin],aix[origin].extend),extend=eval("(function(ops){ var "+x[0]+"=_.extend(_.extend({},"+x[1]+"),ops||{}); "+x[2]+"})");return _.compose(extend.prototype,aix[origin].prototype),extend.prototype.constructor=extend,_.define(extend,"base",{value:aix[origin],writable:!1,enumerable:!1,configurable:!1}),extend}}function getHash(e){var t=e.search("#");return t>0?e.slice(t+1):""}function changeHash(e,t,n){_.foreach(this.routes,function(i,r){RegExp(r,"i").test(e)&&changeHashReg.call(this,i,[n,e,t,r])},this)}function changeHashReg(e,t){switch(_.typeof(e)){case"function":e.apply(this||_.root,t);break;default:_.foreach(_.isString(e)?e.split(","):e,function(e){this.actions[e].apply(this||_.root,t)},this)}}function linkConect(e,t){var n=function(){var n=arguments;t.apply(this,n),this._connect.length&&_.loop(this._connect,function(t){_.dispatch(t,this.name+":"+e,null,[this.model.parse?this.model.parse():this.model].concat(_.slice(n)))},this)};return t.link=n,n}function isSelfProp(e){return 0===e.search("\\[")&&e.search("\\]")>-1}var aix={},AIX_VIEW_COUNT=0,AIX_ROUTE_COUNT=0,AIX_MODELS_COUNT=0,AIX_COLLECTION_COUNT=0,AIX_VIEW_DEFAULT={el:"",template:""},AIX_ROUTE_DEFAULT={routes:{},actions:{}},AIX_MODELS_DEFAULT={data:""},AIX_COLLECTION_DEFAULT={data:[],model:0},RESTFUL_enable={get:"GET",put:"PUT",save:"POST",post:"POST",pull:"PULL",fetch:"FETCH",update:"UPDATE",delete:"DELETE"},RESTFUL_disable={get:"GET",put:"POST",save:"POST",post:"POST",pull:"POST",fetch:"GET",update:"POST",delete:"POST"},RESTFUL_LIST=RESTFUL_disable;aix.config={restful:!1},_.watch(aix.config,"restful",function(e){return RESTFUL_LIST=e?RESTFUL_enable:RESTFUL_disable,e});var strip_comment=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;return aix.model=function(e){e=e||{};var t=this;_.define(this,{aid:{value:++AIX_MODELS_COUNT,writable:!1,enumerable:!1}}),this.change=!1,_.isObject(e.events)&&_.foreach(e.events,function(e,t){_.addEvent(this,t,e)},this),_.isFunction(e.validate)&&_.define(t,"validate",{value:e.validate,writable:!1,enumerable:!1,configurable:!1}),delete e.validate,delete e.change,delete e.events,_.extend(this,_.extend(_.clone(AIX_MODELS_DEFAULT),e)),_.watch(this,"data",function(e,t){if(_.isFunction(this.validate)){var n=!0;return(_.isFunction(this.validate)?!this.validate.call(this,e):0)&&(n=!1),n?(_.isequal(e,t)||(_.dispatch(this,"change",null,[e,t]),this.change=!0),_.dispatch(this,"validate",null,[e,t]),_.dispatch(this,"validate:success",null,[e,t]),e):(_.dispatch(this,"validate",null,[e,t]),_.dispatch(this,"validate:fail",null,[e,t]),t)}return _.isequal(e,t)||(_.dispatch(this,"change",null,[e,t]),this.change=!0),e}.bind(this)),_.dispatch(this,"init")},aix.model.prototype={constructor:aix.model,get:function(e){return _.isString(e)||_.isNumber(e)?_.clone(this.data[e]||""):_.clone(this.data)},set:function(){var e=_.slice(arguments);return e.length>1?(this.dispatch("change",null,[e[1],this.data[e[0]]]),this.data[e[0]]=e[1]):this.data=e[0],this.dispatch("set",null,e)},addEvent:function(e,t){return _.isFunction(t)&&_.addEvent(this,e,t),this},removeEvent:function(e,t){return _.removeEvent(this,e,t)},dispatch:function(e,t,n){return _.dispatch(this,e,_.isFunction(t)?t:null,n)},trigger:function(){return this.dispatch.apply(this,arguments)},listen:function(e,t){return _.isObject(this.data)&&_.watch(this.data,e,t),this},unlisten:function(e){return _.isObject(this.data)&&_.unwatch(this.data,e),this},add:function(){var e=_.slice(arguments),t=_.clone(this.data),n=_.typeof(t);return _.foreach(e,function(e){switch(n){case"number":t+=_.isNumber(+e)?+e:0;break;case"string":t+=e.toString();break;case"array":t=t.concat(e);break;case"object":_.isObject(e)&&_.extend(t,e)}}),this.data=t,this.dispatch("add",null,e)},remove:function(){var e=_.slice(arguments),t=_.clone(this.data),n=_.typeof(t);return _.foreach(e,function(e){switch(n){case"string":t=t.replace(e.toString,"");break;case"array":_.isArray(e)?_.foreach(e,function(e){_.not(t,e)}):_.not(t,e);break;case"object":_.isArray(e)?_.foreach(e,function(e){delete t[e]}):delete t[e]}}),e.length?this.data=t:this.data=null,this.dispatch("remove",null,e)}},aix.collection=function(e){e=e||{};var t=this;_.define(this,{cid:{value:++AIX_COLLECTION_COUNT,writable:!1,enumerable:!1}}),this.change=!1,_.isObject(e.events)&&_.foreach(e.events,function(e,t){_.addEvent(this,t,e)},this),_.isFunction(e.validate)&&_.define(this,"validate",{value:e.validate,writable:!1,enumerable:!1,configurable:!1}),delete e.validate,delete e.change,delete e.events,_.extend(this,_.extend(_.clone(AIX_COLLECTION_DEFAULT),e)),this.model&&(this.data=_.filter(this.data,function(e){return e.constructor===this.model}.bind(this))),_.watch(this,"data",function(e,n){if(_.isArray(e)||(e=[e]),_.isFunction(t.validate)){var i=!0;return _.foreach(e,function(e){(this.model?e.constructor!==this.model:0)&&(i=!1),(_.isFunction(this.validate)?!this.validate.call(this,e):0)&&(i=!1)},this),i?(_.isequal(e,n)||(_.dispatch(this,"change",null,[e,n]),this.change=!0),_.dispatch(this,"validate",null,[e,n]),_.dispatch(this,"validate:success",null,[e,n]),e):(_.dispatch(this,"validate",null,[e,n]),_.dispatch(this,"validate:fail",null,[e,n]),n)}return _.isequal(e,n)||(_.dispatch(this,"change",null,[e,n]),this.change=!0),e}.bind(this)),_.dispatch(this,"init")},aix.collection.prototype={constructor:aix.collection,addEvent:function(e,t){return _.isFunction(t)&&_.addEvent(this,e,t),this},removeEvent:function(e,t){return _.removeEvent(this,e,t)},listen:function(e,t){return _.isObject(this.data)&&_.watch(this.data,e,t),this},unlisten:function(e){return _.isObject(this.data)&&_.unwatch(this.data,e),this},add:function(){var e=this.data.length,t=_.slice(arguments),n=_.slice(this.data);return t.length&&(n=n.concat.apply(n,t)),_.isequal(this.data,n)?this:(this.data=n,this.data.length===e?this:this.dispatch("add",null,t))},remove:function(e){var t,n=this.data.length;return _.isString(e)?(t=_.slice(this.data),t=_.cat(t,function(t){return t.aid!=="#"+e})):_.isObject(e)&&(_.isFunction(this.model)?e instanceof this.model&&(t=_.slice(this.data),t=_.not(t,e)):(t=_.slice(this.data),t=_.not(t,e))),t?(this.data=t,this.data.length===n?this:this.dispatch("remove",null,[e])):this},get:function(e){return _.isNumber(e)?this.model?_.filter(this.data,function(t){return t.aid==="#"+e}):this.data[e]:_.isString(e)?this.model?_.pluck(this.parse(),e):_.pluck(this.data,e):_.slice(this.data)},set:function(e){return this.data=_.isArray(e)?e:[e],this.dispatch("set",null,[e])},dispatch:function(e,t,n){return _.dispatch(this,e,_.isFunction(t)?t:null,n)},trigger:function(e,t,n){return this.dispatch(e,t,n)}},_.foreach(["loop","foreach","splice","push","unshift","sort","unique","reject","find","filter","map","cat","groupby","toarray","forarray","pairs","not","hook","bale","pluck","reverse","shuffle","merge","compose"],function(e){aix.model.prototype[e]=_genertor_(e),aix.collection.prototype[e]=_genertor_(e)}),_.foreach(["keys","clone","contain","findindex","has","isequal","requery","typeof","combom"],function(e){aix.model.prototype[e]=_genertor_$(e),aix.collection.prototype[e]=_genertor_$(e)}),_.foreach(["pop","shift"],function(e){aix.model.prototype[e]=_genertor__(e),aix.collection.prototype[e]=_genertor__(e)}),_.extend(aix.model.prototype,{toJSON:function(){return _.isArray(this.data)||_.isObject(this.data)?JSON.stringify(this.data):this.data},parse:function(){return _.clone(this.data)},pipe:function(e,t,n,i,r,o){var a,s,u=this,c={type:RESTFUL_LIST[e.toLowerCase()],aysnc:!0},l=_.isFunction(n);_.isString(t)?(c.url=t,c.param=l?{}:n||{},a=l?n:i||_.NULL,s=l?i||_.NULL:r||_.NULL):_.isObject(t)?(c.url=u.url||"/",c.param=l?t:n||{},a=l?n:i||_.NULL,s=l?i||_.NULL:r||_.NULL):(c.url=u.url||"/",a=_.NULL,s=_.NULL),c.header=o||{},c.success=function(t,n,i){a.call(u,t,n,i),u.dispatch(e+":success",null,[t,n,i])},c.fail=function(t,n){s.call(u,t,n),u.dispatch(e+":fail",null,[t,n])};var h=_.aix(c);return this.dispatch(e,null,[h])},aget:function(e,t,n,i,r){return this.pipe.apply(this,["get",e||this.url||"",t,n,i,r])},fetch:function(e,t,n,i){return this.pipe.apply(this,["fetch",this.url||"",e,function(e,n,i){this.data=JSON.parse(e),(t||_.NULL).call(this,e,n,i)},n,i])},sync:function(){return this.fetch.apply(this,arguments)},post:function(e,t,n,i,r){return this.pipe.apply(this,["post",e||this.url||"",t||this.parse(),n,i,r])},save:function(e,t,n){return this.pipe.apply(this,["save",this.url||"",this.parse(),e,t,n])}}),_.extend(aix.collection.prototype,{toJSON:function(){var e=[];return _.foreach(this.data,function(t){e.push(t.get?t.get():t)}),JSON.stringify(e)},parse:function(){return JSON.parse(this.toJSON())},pipe:function(e,t,n,i,r,o){var a,s,u=this,c={type:RESTFUL_LIST[e.toLowerCase()],aysnc:!0},l=_.isFunction(n);_.isString(t)?(c.url=t,c.param=l?{}:n||{},a=l?n:i||_.NULL,s=l?i||_.NULL:r||_.NULL):_.isObject(t)?(c.url=u.url||"/",c.param=l?t:n||{},a=l?n:i||_.NULL,s=l?i||_.NULL:r||_.NULL):(c.url=u.url||"/",a=_.NULL,s=_.NULL),c.header=o||{},c.success=function(t,n,i){a.call(u,t,n,i),u.dispatch(e+":success",null,[t,n,i])},c.fail=function(t,n){s.call(u,t,n),u.dispatch(e+":fail",null,[t,n])};var h=_.aix(c);return this.dispatch(e,null,[h])},aget:function(e,t,n,i,r){return this.pipe.apply(this,["get",e||this.url||"",t,n,i,r])},fetch:function(e,t,n,i){return this.pipe.apply(this,["fetch",this.url||"",e,function(e,n,i){var r=JSON.parse(e);this.model&&_.foreach(r,function(e,t){r[t]=new this.model({data:e})},this),this.data=r,(t||_.NULL).call(this,e,n,i)},n,i])},sync:function(){return this.fetch.apply(this,arguments)},post:function(e,t,n,i,r){return this.pipe.apply(this,["post",e||this.url||"",t||this.parse(),n,i,r])},save:function(e,t,n){return this.pipe.apply(this,["save",this.url||"",this.parse(),e,t,n])}}),$=$||_.NULL,aix.view=function(e){e=e||{};var t=this;return _.define(this,{vid:{value:++AIX_VIEW_COUNT,writable:!1,enumerable:!1}}),_.isObject(e.events)&&_.foreach(e.events,function(t,n){var i=n.split(":");i.length>1?$(e.el).on(i[0],i[1],{self:this},t):_.addEvent(this,n,t)},this),e.template&&!_.isString(e.template)||(e.template=_.isFunction(e.build)?e.build.call(this,e.template||""):_.doom(e.template||"")),e.render&&_.isFunction(e.render)||(e.render=function(){return $(this.el).html(this.template.apply(this,arguments))&&this}),delete e.change,delete e.events,_.isString(e.url)?(_.aix({url:e.url,cache:!_.isBoolean(e.cache)||e.cache,success:function(n){e.template=_.isFunction(e.build)?e.build.call(t,n):_.doom(n),_.extend(t,_.extend(_.clone(AIX_VIEW_DEFAULT),e)),_.dispatch(t,"init")},fail:function(t){console.error("Fetch template url->["+e.url+"] has fail!"),console.log(t)}}),this):(_.extend(this,_.extend(_.clone(AIX_VIEW_DEFAULT),e)),void _.dispatch(this,"init"))},aix.view.prototype={addEvent:function(e,t){var n=e.split(":");return n.length>1?$(this.el).on(n[0],n[1],{self:this},t):_.addEvent(this,e,t),this},removeEvent:function(e,t){var n=e.split(":");return n.length>1?$(this.el).off(n[0],n[1],t):_.removeEvent(this,e,t),this},empty:function(){return $(this.el).empty(),this},release:function(){return $(this.el).off(),this},destroy:function(e){return $(this.el).off()[e?"remove":"empty"](),_.define(this,"el",{value:null,writable:!1,enumerable:!1,configurable:!1}),_.removeEvent(this)},dispatch:function(e,t,n){return _.dispatch(this,e,t,n)},trigger:function(){return this.dispatch.apply(this,arguments)}},aix.route=function(e){e=e||{};var t=this;_.isObject(e.events)&&_.foreach(e.events,function(e,t){_.addEvent(this,t,e)},this),delete e.events,_.extend(this,_.extend(_.clone(AIX_ROUTE_DEFAULT),e)),_.addEvent(this,"hashchange",changeHash),_.define(this,{history:{value:{old:"",now:_.root.location.href},writable:!0,enumerable:!1},rid:{value:AIX_ROUTE_COUNT,writable:!1,enumerable:!1,configurable:!1},event:{value:function(e){return _.root.location.href===t.history.now?e.preventDefault():(t.history.old=t.history.now,t.history.now=_.root.location.href,_.dispatch(t,"hashchange",null,[getHash(_.root.location.href),getHash(t.history.old),e]))},writable:!1,enumerable:!1,configurable:!1}}),_.dispatch(this,"init")},aix.route.prototype={constructor:aix.route,addEvent:function(e,t){return _.isFunction(t)&&_.addEvent(this,e,t),this},removeEvent:function(e,t){return _.removeEvent(this,e,t)},dispatch:function(e,t,n){return _.dispatch(this,e,t,n)},trigger:function(){return this.dispatch.apply(this,arguments)},addRoute:function(e,t){return(_.isString(t)||_.isArray(fnname))&&(this.routes[e]=fnname),this},removeRoute:function(e){return delete this.routes[e],this},addAction:function(e,t){return _.isString(e)&&isFunction(t)&&(this.actions[e]=t),this},removeAction:function(e){return delete this.actions[e],this},listen:function(){return this._listen||(_.define(this,"_listen",{value:1,writable:!1,enumerable:!1,configurable:!0}),_.root.addEventListener("hashchange",this.event),this.dispatch("listen"),this.dispatch("hashchange",null,[getHash(window.location.href)])),this},stoplisten:function(){return delete this._listen&&(_.root.removeEventListener("hashchange",this.event),this.dispatch("stoplisten")),this},assign:function(e){if(this._listen){var t=_.root.location.href,n=t.search("#");n>0&&(t=t.slice(0,n)),_.root.location.href=t+("#"===e.toString().slice(0,1)?"":"#")+e}return this},addhash:function(e){var t=_.root.location.href+(e||"").toString();return t!==_.root.location.href&&(_.root.location.href=t),this}},aix.component=function(e){if(e=e||{},!e.name&&!_.isString(e.name))throw new TypeError("Aix-Comment must defined [name] property type to string.");var t=_.extend({model:aix.model,view:aix.view,events:{}},e||{});_.define(this,{model:{value:_.isFunction(t.model)?new t.model:t.model,writable:!1,enumerable:!0,configurable:!1},view:{value:_.isFunction(t.view)?new t.view:t.view,writable:!1,enumerable:!0,configurable:!1},_connect:{value:[],writable:!1,enumerable:!1,configurable:!1}}),_.loop(t.events,function(e,t){this.addEvent(t,e)},this),delete t.el,delete t.model,delete t.view,delete t.events,_.compose(this,t),_.dispatch(this,"init")},aix.component.prototype={addEvent:function(e,t){if(!isSelfProp(e))return _.addEvent(this,e,linkConect(e,t));var n=e.split("|"),i=n[0].substr(1,n[0].length-2),r=n[1];return null!=this[i]?_.isFunction(this[i].addEvent)?this[i].addEvent(r,t.bind(this)):_.addEvent(this[i],r,t.bind(this)):void 0},removeEvent:function(e,t){if(!isSelfProp(e))return _.removeEvent(this,e,t.link||t);var n=e.split("|"),i=n[0].substr(1,n[0].length-2),r=n[1];return null!=this[i]?_.isFunction(this[i].removeEvent)?this[i].removeEvent(r,t.bind(this)):_.removeEvent(this[i],r,t.bind(this)):void 0},dispatch:function(e,t,n){return _.dispatch(this,e,t,n)},trigger:function(){return this.dispatch.apply(this,arguments)},connect:function(e){var t=_.isArray(e)?e:[e];return _.loop(t,function(e){null!=e&&_.isObject(e)&&(this._connect.push(e),_.isArray(e._connect)&&e._connect.push(this))},this),this}},aix.view.extend=createExtend("view"),aix.model.extend=createExtend("model"),aix.route.extend=createExtend("route"),aix.component.extend=createExtend("component"),aix.collection.extend=createExtend("collection"),aix});