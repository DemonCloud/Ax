!(function(t,e,n){"function"==typeof define&&define.amd?define("ax",["struct"],(function(t){return n(e,t)})):"undefined"!=typeof exports?n(exports,require("ax-struct-js")):t.ax=n(e,t.struct)})(this,{},(function(r,i){"use strict";var t,s,e,d,u,m,n,o,a,c,h,l,f,p,v,g,y,b,x,_,k,S,E,P,T,O,N,w,A,M,D,C,L,j,I,R,H,q,z,J="4.2.5",$=[],F={},Q=i.root,V=[],X=Q.localStorage,U="Ax@",G=String.fromCharCode,Y=0,W=arguments,Z=["use","events","_assert"],B=["root","mount","props","events","render","template","destroy","cache"],K=["name","data","store","change","events","validate","filter","lock"],tt={},et={use:[]},nt={data:{},validate:{}},it={get:"GET",send:"GET",post:"POST",sync:"POST",put:"POST",delete:"POST",patch:"POST",fetch:"GET"},rt=i.v8(),ot=i.ayc(),st=i.lock(),at=i.keys(),ut=i.noop(),ct=i.define(),ht=i.slice(),lt=i.clone(),ft=i.extend(),pt=i.eq(),dt=i.convert("string"),mt=i.type(),vt=i.type("object"),gt=i.type("func"),yt=i.type("num"),bt=i.type("bool"),xt=i.type("str"),_t=i.type("int"),kt=i.type("array"),St=i.type("arraylike"),Et=i.type("primitive"),Pt=i.type("float"),Tt=i.type("dom"),Ot=i.type("elm"),Nt=i.type("node"),wt=i.type("required"),At=i.op(),Mt=i.op("object"),Dt=i.op("array"),Ct=i.map(),Lt=i.event("on"),jt=i.event("off"),It=i.event("emit"),Rt=i.prop("get"),Ht=i.prop("set"),qt=i.prop("not"),zt=i.has(),Jt=i.ajax(),$t=i.size(),Ft=i.link(),Qt=i.doom(),Vt=i.doom("axt"),Xt=i.merge(),Ut=i.index(),Gt=i.index("one"),Yt=i.html("decode"),Wt=i.cool();function Zt(e){return function(t){return new e(vt(t)?t:{})}}function Bt(n){return function(e){var t=function(t){return new n(Xt(e,t||{}))};return t.constructor=n,t}}function Kt(t){return t._zid||(t._zid=h++)}function te(t,e,n,i){if((e=ee(e)).ns)var r=(o=e.ns,RegExp("(?:^| )"+o.replace(" "," .* ?")+"(?: |$)"));var o;return(l[Kt(t)]||[]).filter((function(t){return t&&(!e.e||t.e==e.e)&&(!e.ns||r.test(t.ns))&&(!n||Kt(t.fn)===Kt(n))&&(!i||t.sel==i)}))}function ee(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function ne(t,e){return t.del&&!f&&t.e in p||!!e}function ie(t){return v[t]||y[t]||g[t]||f&&p[t]||t}function re(f,t,i,p,r,o,s){var e=Kt(f),a=l[e]||(l[e]=[]);At(t.split(/\s/),(function(t){var l,e,n=ee(t);n.fn=i,n.sel=r,n.e in v&&(i=function(t){var e=t.relatedTarget;if(!e||e!==this&&!this.contains(e))return n.fn.apply(this,arguments)}),n.del=o,l=o||i,n.proxy=function(t){var e,n,i,r,o,s=t.type,a=t.target.nodeName,u="true"===t.target.contentEditable,c=zt(b,s)&&("INPUT"===a||"TEXTAREA"===a||u),h=new m.xEvent(t=ue(t));return!(t.isImmediatePropagationStopped()||c&&t.target._compositionIn)&&(h.data=p,c&&(i=t.target,o=0,null!=i.selectionStart?o=i.selectionStart:document.selection&&(i.focus(),(r=document.selection.createRange()).moveStart("character",-i.value.length),o=r.text.length),e=o),!1===(n=l.apply(f,void 0===h._args?[h]:[h].concat(h._args)))&&(t.preventDefault(),t.stopPropagation()),e&&(function(t,e){if(t.createTextRange){var n=t.createTextRange();return n.move("character",e),n.select()}t.selectionStart?t.setSelectionRange(e,e,t.focus()):t.focus()})(t.target,e),n)},n.i=a.length,a.push(n),(e=ie(n.e))in y&&(f.addEventListener("compositionstart",(function(t){t.target._compositionIn=!0})),f.addEventListener("compositionend",(function(t){t.target._compositionIn=!1,x||m(t.target).trigger("input")}))),f.addEventListener(e,n.proxy,ne(n,s))}))}function oe(e,t,n,i,r){var o=Kt(e);Dt((t||"").split(/\s/),(function(t){At(te(e,t,n,i),(function(t){delete l[o][t.i],e.removeEventListener(ie(t.e),t.proxy,ne(t,r))}))}))}function se(){return!0}function ae(){return!1}function ue(i,r){if(r||!i.isDefaultPrevented){r||(r=i),At(k,(function(t,e){var n=r[e];i[e]=function(){return this[t]=se,n&&n.apply(r,arguments)},i[t]=ae}));try{i.timeStamp||(i.timeStamp=Date.now())}catch(t){}(void 0!==r.defaultPrevented?r.defaultPrevented:"returnValue"in r?!1===r.returnValue:r.getPreventDefault&&r.getPreventDefault())&&(i.isDefaultPrevented=se)}return i}function ce(t,e){if(!e._v)return!0;for(var n,i,r=e._asv($),o=[],s=at(r),a=0,u=s.length;a<u;a++)if(!(0,r[s[a]])(n=Rt(t,s[a]))){o.push(s[a],n);break}return i=!$t(o),e.emit("validate:"+(i?"success":"fail"),i?[lt(t)]:o),i}function he(t,e){return this.on(e,t)}function le(o,s){return function(t,e){var n,i,r=o(t);return e?r:r||(n=t,i="[ validate."+dt(s)+" ]",console.warn("The value Of *( "+n+" ) with type [ "+mt(n)+" ] not pass validate! "+dt(i)),!1)}}function fe(e){return function(t){return t instanceof e}}function pe(t){return t.split("").reverse().join("")}function de(e,n){return function(t){return t===$?e:n}}function me(t,e){var n,i,r,o,s=(o=t,function(){return o.emit("beforeRender",arguments),arguments}),a=(i=t,r=e,function(t){return r.apply(i,t),t}),u=(n=t,function(t){return n.root._vid=n._vid,n.emit("completeRender",t)});return Ft(s,a,u)}function ve(e,t){if(gt(t)){var n=me(e,t.bind(e));ct(e,"render",{get:function(){return n},set:function(t){return gt(t)&&(n=me(e,t.bind(e))),n},enumerable:!1,configurable:!1})}return e}function ge(t){if(!Ot(t)&&!St(t))throw new TypeError("el must be typeof DOMElement or NodeList collections -> not "+t);return!0}function ye(t,e){t&&t._updateSlotQueue.length&&(Dt(t._updateSlotQueue,function(t,e){var n,i,r,o=Rt(this,e.name);if(o)return n=ut,i=t[0],r=e.path&&vt(i)?[Rt(i,e.path)]:t,n=o.constructor!==s||u.view(o,!0)?gt(o)?function(){o.apply(this,[e.root].concat(r))}.bind(this):xt(o)||yt(o)?function(){e.root.textContent=o}:function(){e.root.textContent=""}:function(){var t=o({root:e.root});t.render.apply(t,r)},this.useAsyncRenderSlot?ot(n):n()}.bind(t,e)),t._updateSlotQueue=[])}function be(e){return function(t){return t.name===e}}function xe(t,e){var n=this._assert(Wt,$),i=xt(t)?[t]:kt(t)?t:[];return Dt(i,(function(t){e.call(this,n,t)}),this),this}return n=function(t){this.el=St(t)?ht(t):Ot(t)?[t]:[]},m=function(t){return m.init(t)},h=1,l={},f="onfocusin"in i.root,p={focus:"focusin",blur:"focusout"},v={mouseenter:"mouseover",mouseleave:"mouseout"},g={check:"change"},y={change:"input",input:"input"},b=["input","keypress","keydown","keyup"],x=-1<i.root.navigator.userAgent.indexOf("Firefox"),_=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,k={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"},S=Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector,m.init=function(t){return new n(t)},m.matchz=function(t,e){return null!==t&&t!==document&&xt(e)&&S.call(t,e)},m.event={add:re,remove:oe},m.proxy=function(t,e){var n,i=2 in arguments&&ht(arguments,2);if(gt(t))return(n=function(){return t.apply(e,i?i.concat(ht(arguments)):arguments)})._zid=Kt(t),n;if(xt(e))return i?m.proxy.apply(null,(i.unshift(t[e],t),i)):m.proxy(t[e],t);throw new TypeError("expected function")},m.Event=function(t,e){var n,i,r;if(xt(t)||(t=(e=t).type),i=document.createEvent(zt(z.MouseEvent,t)?"MouseEvent":"Events"),r=!0,e)for(n in e)"bubbles"===n?r=!!e[n]:i[n]=e[n];return i.initEvent(t,r,!0),ue(i)},m.xEvent=function(t){var e;for(e in t)this[e]=t[e]},E={class:"className",style:"style.cssText",placeholder:"@placeholder",maxlength:"@maxlength",minLength:"@minLength",max:"@max",min:"@min",href:"@href",checked:"*checked",disabled:"*disabled",readonly:"*readonly",required:"*required",selected:"*selected",controls:"*controls",ended:"*ended",muted:"*muted",hidden:"*hidden",seeking:"*seeking",paused:"*paused",loop:"*loop",autoplay:"*autoplay",multiple:"*multiple",autofocus:"*autofocus",autocomplete:"*autocomplete",draggable:"*draggable",spellcheck:"*spellcheck",translate:"*translate",specified:"*specified",defer:"*defer",async:"*async"},P=["no","replace","append","remove","modifytext","withtext","removetext","addattr","modifyattr","removeattr"],T=/<\/([^><]+?)>|<([^><]+?)\/>|<([^><]+?)>|([^><]+)|$/g,O={input:1,br:1,hr:1,img:1,meta:1,area:1,base:1,col:1,isindex:1,command:1,embed:1,keygen:1,link:1,head:1,param:1,source:1,track:1,wbr:1,path:1,circle:1,ellipse:1,line:1,rect:1,use:1,stop:1,polyline:1,polygon:1},N=/(\S+)=["'](.*?)["']|([\w-]+)/gi,w=/^\{|\}$/gi,A=/^\{([^'"\s]+)\}$/i,M=/^[\r\n\f\t\s]+|[\r\n\f\t\s]+$/gi,D=/^default[^\s]+/i,C=function(t,e,n){var i,r=E[e]||e;n=xt(n)?Yt(n):n,D.test(r)?(r=r.slice(7).toLowerCase(),null!=(i=t.getAttribute(r)||t[r])&&""!==i||C(t,r,n)):"*"===r[0]?Ht(t,r.slice(1),"true"===n||!0===n):"@"===r[0]?t.setAttribute(r.slice(1),n):":"===r[0]?m(t).on(r.slice(1),n):Ht(t,r,n)},L=function(t,e,n){if(":"===e[0]&&gt(n))m(t).off(e.slice(1),n);else if(t[e]&&!delete t[e])try{t[e]=null}catch(t){}else t.removeAttribute(e)},j=function(t,e,n){var i,r=e;return A.test(e)&&(r=void 0!==(i=n[e.replace(w,"")])?i:e),":"===t[0]&&(r=gt(i)?i:Function("event",dt(e))),r},I=function(n,t){var i={};return Mt(t,(function(t,e){n[e]===t&&(i[e]=1)})),i},R=[ut,function(t){var e=t.s;e&&e.parentNode&&e.parentNode.replaceChild(t.n,e)},function(t){var e=t.s;e&&e.appendChild(t.n)},function(t){var e=t.s;e.parentNode&&e.parentNode.removeChild(e)},function(t){var e=t.s;if(t.isSlot)return e._destory&&e._destory(),e.parentNode.replaceChild(t.n,e);e.textContent=Yt(t.c)},function(t){var e=t.s;if(t.isSlot)return e._destory&&e._destory(),e.parentNode.replaceChild(t.n,e);e.textContent=Yt(t.c)},function(t){t.s.innerHTML=t.n.innerHTML},function(n){Mt(n.a,(function(t,e){C(n.s,e,t)}))},function(t){var n=t.s,i=I(t.o,t.a);Mt(t.o,(function(t,e){e in i||L(n,e,t)})),Mt(t.a,(function(t,e){e in i||C(n,e,t)}))},function(n){Mt(n.a,(function(t,e){L(n.s,e,t)}))}],H=function(t,e){var n,i,r=xt(t)?t:"";if(r&&e)return n={},i=r.trim().split("::"),n.name=i[0],n.path=i[1],n.root=e,n},q={treeDiff:function(t,e,n,i,r,o){if(void 0===t)n.unshift(this.createPatch(i,e,2,o));else if(void 0===e)n.push(this.createPatch(t,0,3,o));else if(t.tagName===e.tagName){if(e.isSlot||t.isSlot)return n.push(this.createPatch(t,e,5,o)),n;if(pt(t.attributes,e.attributes)||(t.attributes&&e.attributes?n.push(this.createPatch(t,e,8,o)):t.attributes?e.attributes||n.push(this.createPatch(t,e,9,o)):n.push(this.createPatch(t,e,7,o))),t.text!==e.text)return t.text&&e.text&&t.text!==e.text?n.push(this.createPatch(t,e,4,o)):t.text?e.text||n.push(this.createPatch(t,e,6,o)):n.push(this.createPatch(t,e,5,o)),n;var s,a=t.child.length,u=e.child.length;if(a||u)if(a<u){for(s=a;s<u;s++)n.push(this.createPatch(t,e.child[s],2,o));for(s=a;s--;)this.treeDiff(t.child[s],e.child[s],n,t,e,o)}else if(u<a){for(s=a-1;u<=s;s--)n.push(this.createPatch(t.child[s],0,3,o));for(s=u;s--;)this.treeDiff(t.child[s],e.child[s],n,t,e,o)}else for(s=Math.max(a,u);s--;)this.treeDiff(t.child[s],e.child[s],n,t,e,o)}else t.tagName!==e.tagName&&n.push(this.createPatch(t,e,1,o));return n},applyPatch:function(e,t){Dt(Ct(t,function(t){return t.path=t.s,t.s=this.mapTreeNode(e,t.s),t}.bind(this)),(function(t){R[t.t].call(e,t)}))},mapTreeNode:function(t,e){for(var n,i=0,r=t.children;i<e.length&&r[e[i]];i++)r=(n=r[e[i]]).children;return n},createSelector:function(t){for(var e=[t.i];t=t.parent;)void 0!==t.i&&e.unshift(t.i);return e},createPatch:function(t,e,n,i){var r,o=this.createSelector(t),s=e.isSlot;switch(P[n]){case"replace":r={t:1,s:o,n:this.createDOMElement(e,i)};break;case"append":r={t:2,s:o,n:this.createDOMElement(e,i)};break;case"remove":r={t:3,s:o};break;case"modifytext":r={t:4,s:o,c:e.text,isSlot:s},s&&(r.n=this.createDOMElement(e,i));break;case"withtext":r={t:5,s:o,c:e.text,isSlot:s},s&&(r.n=this.createDOMElement(e,i));break;case"removetext":r={t:6,s:o,n:this.createDOMElement(e,i)};break;case"addattr":r={t:7,s:o,a:e.attributes};break;case"modifyattr":r={t:8,s:o,a:e.attributes,o:t.attributes};break;case"removeattr":r={t:9,s:o,a:t.attributes};break;default:r={t:0}}return r},createTreeFromHTML:function(t,o){var s,e={tagName:"__AX_DEFAULT_VIEWROOT__",isRoot:!0,child:[]},a=e,u=e.child;return t.replace(T,function(t,e,n,i,r){return t&&t.replace(M,"")&&(e?(a=a.parent,u=a.child):n?((s=this.createObjElement(n,o)).i=u.length,u.push(s),s.parent=a):i?((s=this.createObjElement(i,o)).i=u.length,u.push(s),s.parent=a,s.tagName in O||(u=(a=s).child)):r&&r.trim()&&(a.text=r)),t}.bind(this)),e},createObjElement:function(t,e){var n,i,r,o=t.split(" "),s=vt(e)?e:{},a=o.shift(),u=o.join(" "),c={tagName:a,child:[]};if("slot"===a&&(c.isSlot=!0),u){for(n={};i=N.exec(u);)i[1]?n[i[1]]=j(i[1],i[2],s):r?(n[r]=j(r,i[0],s),r=0):r=i[0];c.attributes=n}return c},createDOMElement:function(t,e){var n,i=document.createElement(t.tagName);return e&&t.attributes&&t.attributes.ref&&(e.refs[t.attributes.ref]=i),Mt(t.attributes,(function(t,e){C(i,e,t)})),e&&t.isSlot?(n=H(t.text,i))&&e._updateSlotQueue.push(n):(t.text&&(i.textContent=Yt(t.text)),t.child.length&&Dt(t.child,(function(t){i.appendChild(this.createDOMElement(t,e))}),this)),i}},z={MouseEvent:["click","dbclick","mouseup","mousedown","mouseout","mouseover","mouseenter","mouseleave"]},n.prototype={get:function(t){return 0 in arguments?this.el[+t+(t<0?this.length:0)]:this.el},each:function(t,e){return Dt(this.el,t,e||this),this},find:function(e){var n=[];return Dt(this.el,(function(t){n=ht(t.querySelectorAll(e)).concat(n)})),m(n)},closest:function(t,e){for(var n,i=this.el,r=this.get(0),o=0,s=i.length;o<s;r=i[++o]){for(;r&&!n&&r!==e;)m.matchz(r=r.parentNode,t)&&(n=r);if(n)break}return m(n||[])},on:function(t,i,r,o,s){var e;return t&&!xt(t)?(At(t,(function(t,e){this.on(e,i,r,t,s)}),this),this):(xt(i)||gt(o)||!1===o||(o=r,r=i,i=void 0),void 0!==o&&!1!==r||(o=r,r=void 0),gt(r)&&xt(i)&&(s=o,o=r),!1===o&&(o=ae),this.each((function(n){i&&(e=function(t){var e=m.matchz(t.target,i)?t.target:m(t.target).closest(i,n).get(0);e&&e!==n&&o.apply(s||e,[ft(t,{currentTarget:e,liveFired:n})].concat(ht(arguments,1)))}),re(n,t,o,r,i,e)})))},off:function(e,n,i){return e&&!xt(e)?(At(e,(function(t,e){this.off(e,n,t)}),this),this):(xt(n)||gt(i)||!1===i||(i=n,n=void 0),!1===i&&(i=ae),this.each((function(t){oe(t,e,i,n)})))},trigger:function(e,n){return(e=xt(e)?m.Event(e):ue(e))._args=n,this.each((function(t){e.type in p&&gt(t[e.type])?t[e.type]():"dispatchEvent"in t?t.dispatchEvent(e):m(t).triggerHandler(e,n)}))},triggerHandler:function(e,n){var i,r;return this.each((function(t){(i=(function(t){var e,n={originalEvent:t};for(e in t)_.test(e)||void 0===t[e]||(n[e]=t[e]);return ue(n,t)})(xt(e)?m.Event(e):e))._args=n,i.target=t,At(te(t,e.type||e),(function(t){return r=t.proxy(i),!i.isImmediatePropagationStopped()}))})),r},html:function(e){return this.each((function(t){t.innerHTML=dt(e)}))},remove:function(){return this.each((function(t){t.parentNode.removeChild(m(t).off().get(0))}))},render:function(n,i,r,o){return this.each((function(t){var e=q.createTreeFromHTML(n,r);if(t._vid!==i._vid)return t._destory=function(){i.destroy()},t.appendChild(q.createDOMElement(i.axml=e,i).firstElementChild,t.innerHTML="");q.applyPatch(t,q.treeDiff(i.axml,e,[],null,null,i),i.axml=e),ye(i,o)}))}},r.module=function(t,e){var n=F[t];return n||((n=e.apply(i.root,W))?F[t]=n:void 0)},r.use=function(t){if(F[t])return F[t];console.error("Ax could not find dependency injection defined Module as: [",t,"]")},d={t:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",kAt:function(t,e){return t.charCodeAt(~~(e%t.length))},ecd:function(t){var e,n,i,r,o,s,a=0,u="";if(!t)return t;for(;e=(o=t[a++]<<16|t[a++]<<8|t[a++])>>18&63,n=o>>12&63,i=o>>6&63,r=63&o,u+=this.t.charAt(e)+this.t.charAt(n)+this.t.charAt(i)+this.t.charAt(r),a<t.length;);return((s=t.length%3)?u.slice(0,s-3):u)+"===".slice(s||3)},dcd:function(t){var e,n,i,r,o,s,a=0,u=[];if(!t)return t;for(t+="";e=(s=this.t.indexOf(t.charAt(a++))<<18|this.t.indexOf(t.charAt(a++))<<12|(r=this.t.indexOf(t.charAt(a++)))<<6|(o=this.t.indexOf(t.charAt(a++))))>>16&255,n=s>>8&255,i=255&s,u.push(e),64!==r&&(u.push(n),64!==o&&u.push(i)),a<t.length;);return u},incry:function(t,e){for(var n=0,i=t.length,r=[];n<i;n++)r[n]=t[n].charCodeAt(0)^this.kAt(e,n);return this.ecd(r)},decyt:function(t,e){for(var n=0,i=(t=this.dcd(t)).length;n<i;n++)t[n]=G(t[n]^this.kAt(e,n));return t.join("")},set:function(t,e){X.setItem(U+this.incry(t,pe(t)),this.incry(encodeURIComponent(JSON.stringify(e)),t))},get:function(t){var e=X.getItem(U+this.incry(t,pe(t)));return e?JSON.parse(decodeURIComponent(this.decyt(e,t))):0},rm:function(t){X.removeItem(U+this.incry(t,pe(t)))}},o=(t=function(t){var n,e,i=ft(lt(nt),t||{}),r=i.events,o=i.validate||{},s=gt(i.filter)?i.filter:Wt,a=xt(i.name),u=!!i.store&&a,c=i.data||{},h=u&&d.get(i.name)||c,l=this.isLock=!!i.lock;Mt(r,he,(n=this,e={name:a?i.name:"",_ast:function(t,e){return e===$?t(h):{}},_asl:function(t){return t===$?l:null},_asv:de(o,{}),_ash:de([],[]),_v:!!$t(o),_f:s,_l:function(t,e){e===$&&(l=t)},_c:function(t,e){return e===$?h=t:{}},_s:u},Mt(e,(function(t,e){ct(n,e,{value:t,writable:!1,enumerable:!1,configurable:!1})})),n)),a&&(V[this.name]=this),ft(this,i,K).emit("init").off("init")}).prototype={constructor:t,lock:function(){return this._l(this.isLock=!0,$),this.emit("lock")},unlock:function(){return this._l(this.isLock=!1,$),this.emit("unlock")},back:function(t){if(this._asl($))return this;var e,n=this._ash($);return n.length&&(e=n.pop())&&(this._c(e,$,this.change=!0),t||this.emit("change,back",[e])),this},get:function(t,e){var n=this._ast(Wt,$);return lt(t||0===t?Rt(n,t,e):n)},set:function(t,e,n){var i,r,o,s,a,u,c,h,l,f,p;return this._asl($)||(i=this._ast(Wt,$),r=this._ash($),o=arguments.length,a=!Et(t)&&vt(t),o&&(a?(n=e,(s=this._f(t))&&!pt(i,s)&&ce(s,this)&&(r.push(lt(i)),this._c(s,$,this.change=!0),this._s&&d.set(this.name,s),n||this.emit("change",[lt(s)]))):pt(Rt(i,t),e)||(l=t,f=e,(p=this)._v&&!ce(Ht(p.get(),l,f),p))||(r.push(lt(i)),Ht(i,t,e,this.change=!0),this._s&&d.set(this.name,i),n||(this.emit("change",[lt(i)]),(h={})[c=(u=t.split("."))[0]]=lt(i[c]),1<u.length&&this.emit("change:"+c,[h]),this.emit("change:"+t,[h]))))),this},rm:function(t,e){var n,i,r,o,s;return this._asl($)||(n=this._ast(Wt,$),i=this._ash($),Et(t)&&null!=t&&(i.push(lt(n)),qt(n,t),this._s&&d.set(this.name,n),e||(this.emit("change",[lt(n)]),(s={})[o=(r=t.split("."))[0]]=lt(n[o]),1<r.length&&this.emit("change:"+o,[s]),this.emit("change:"+t,[s]),this.emit("remove:"+t)))),this},moc:function(t,e,n){if(this._asl($))return this;if(xt(t)&&1 in arguments){var i=this.get(t);this.set(t,(o=e,kt(r=i)?r.concat(o):vt(r)?Xt(lt(r),o):o),n)}var r,o;return this},on:function(t,e){return gt(e)&&Lt(this,t,e),this},off:function(t,e){return jt(this,t,e)},emit:function(t,e){return It(this,t,e||[])},subscibe:function(t,e){return Dt(xt(t)?t.split(","):t,(function(t){this.on(t,e)}),this),this},pipe:function(t){if(vt(t)){var e=Xt({type:"get",async:!0,success:ut,error:ut},t);return function(t,e,n,i,r,o){if(this._asl($))return this;var s={url:e||this.url||"",type:it[t],async:!0,param:n||this.pipeParam||{},header:o||this.pipeHeader||{}};return"POST"===s.type&&this.emulateJSON&&(s.header["Content-Type"]="application/json"),s.header["X-HTTP-Method-Override"]=t,s.success=function(){i.apply(this,arguments),this.emit(t+":success",arguments)}.bind(this),s.error=function(){r.apply(this,arguments),this.emit(t+":error",arguments)}.bind(this),this.emit(t,[Jt(s),s])}.call(this,e.type,e.url,e.param,e.success,e.error,e.header)}return this},send:function(t,e){return vt(t)&&(e=t,t=null),this.pipe({type:"send",url:t||this.url,param:this.get(),header:e})},fetch:function(t,e,n){return gt(t)&&(n=e,e=t,t={}),this.pipe({type:"fetch",url:this.url,param:this.get(),success:Ft(gt(e)?e:JSON.parse,this.set.bind(this)),header:n})},sync:function(t,e){return vt(t)&&(e=t,t=null),this.pipe({type:"sync",url:t||this.url,param:this.get(),header:e})},toJSON:function(){return JSON.stringify(this.get())},toString:function(){return dt(this.toJSON())}},a=(s=function(t){this.refs={},this._updateSlotQueue=[];var e=ft(lt(tt),t||{}),n=st(vt(e.props)?e.props:{}),i=e.root,r=e.render,o=e.events,s=e.model,a=e.template;gt(r)||(a=xt(a)?(e.cache?Qt:Vt)(a.trim(),n):gt(a)?a:ut,r=function(){var t=ht(arguments);a!==ut&&(m(this.root).render(a.apply(this,t),this,n,t),ye(this,t))}),i&&ge(i)?(this.root=i,Mt(o,he,ve(this,r)),s&&u.model(s,!0)&&s.on("change",this.render)):this.mount=function(t){if(ge(t))return this.root=i=t,Mt(o,he,ve(this,r)),s&&u.model(s,!0)&&s.on("change",this.render),1 in arguments&&this.render.apply(this,ht(arguments,1)),delete this.mount,this},ft(this,e,B,this._vid=Y++).emit("init").off("init")}).prototype={constructor:s,on:function(t,n){return gt(n)&&Dt(dt(t).split("|"),(function(t){var e=t.split(":");1<e.length?m(this.root).on(e[0],e[1],n,this):Lt(this,t,n)}),this),this},off:function(t,n){return t&&xt(t)?Dt(t.split("|"),(function(t){var e=t.split(":");m(this.root).off(e[0],e[1],n),jt(this,t,n)}),this):m(this.root).off(),this},emit:function(t,n){var e=dt(t),i=e.split(":");return 2<i.length?(Dt(e.split("|"),(function(t){var e=t.split(":");m(this.root).find(e[1]).trigger(e[0],n)}),this),this):1<i.length?(m(this.root).find(i[1]).trigger(i[0],n),this):It(this,t,n)},destroy:function(t){this.root._vid=void 0;var e=function(){m(this.root).off()[t?"remove":"html"](),this.emit("destroy",delete this.root)}.bind(this);ot(e)},toString:function(){return this.root?this.root.outerHTML:""}},c=(e=function(t){var e=ft(lt(et),t||{}),n=e.use,i=[];this._assert=function(t,e){return e===$?t(i):[]},ft(this.use(n),e,Z)}).prototype={constructor:e,all:function(){return this._assert(ht,$)},use:function(t){return xe.call(this,t,(function(t,e,n){(n=V[e])&&!zt(t,n)&&t.push(n)}))},out:function(t){return xe.call(this,t,(function(t,e){var n=Ut(t,be(e));yt(n)&&t.splice(n,1)}))},p:function(t){return Gt(this.all(),be(t))},of:function(t,e){var n,i;return Dt(this.all(),gt(t)?t:(n=t,i=e,function(t){return t[n].apply(t,i)})),this},swap:function(t,e,n){var i,r=this.p(t),o=this.p(e);return r&&o&&(i=r.get(),r.set(o.get(),n),o.set(i,n)),this},select:function(t){return n=(function(t,e){var n=[];switch(mt(e)){case"regexp":Dt(t,(function(t){e.test(t.name)&&n.push(t.name)}));break;case"string":n.push(e);break;case"array":n=e}return n})((e=this).all(),t),(i=r.atom({use:n})).back=function(){return e},i;var e,n,i},toData:function(){return Ct(this._assert(Wt,$),(function(t){return t.get()}))},toChunk:function(){var e={};return this.of((function(t){e[t.name]=t.get()})),e}},r.model=Zt(t),r.view=Zt(s),r.atom=Zt(e),r.model.extend=Bt(t),r.view.extend=Bt(s),r.atom.extend=Bt(e),r.va=u={required:le(wt,"required"),func:le(gt,"function"),int:le(_t,"int"),array:le(kt,"array"),float:le(Pt,"float"),string:le(xt,"string"),object:le(vt,"object"),number:le(yt,"number"),arrayLike:le(St,"arrayLike"),primitive:le(Et,"primitive"),bool:le(bt,"boolean"),dom:le(Tt,"dom"),element:le(Ot,"element"),node:le(Nt,"node"),model:le(fe(t),"model"),view:le(fe(s),"view"),atom:le(fe(e),"atom")},r.VERSION=J,st(t,s,e,d,rt(o),rt(a),rt(c),rt(u),rt(q),rt(r))}));