!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t._=e()}(this,function(){"use strict";function t(t,e,n){for(var i=0,r=t.length;i<r;i++)e.apply(n||t,[t[i],i,t]);return t}function e(e,n,i){var r=m.keys(e);return t(r,function(t,r){n.call(i||e,e[t],t,e)},i||e),e}function n(t){return decodeURIComponent(t.replace(/\+/g," "))}function i(t){return encodeURIComponent(t).replace(" ","%20")}function r(t){return y[t]||t}function o(t){return b[t]||t}function a(t){return"\\"+E[t]}function s(t){var e=document.createElement(t.tagname);return m.foreach(t.attributes,function(t,n){e.setAttribute(n,t)}),t.child?t.child.length||(e.innerHTML=t.content):e.innerHTML=t.content,e}function c(t){var e=document.createElement("x-tree");if(e.id="@",t.length){for(var n=t[1],i=0,r=n.length;i<r;i++)e.appendChild(s(n[i]));for(var i=2,r=t.length;i<r;i++)for(var o=0,a=t[i].length;o<a;o++){var c=t[i][o],u=s(c);e.querySelector("[x-aim='"+c.parent["@"]+"']").appendChild(u)}}return e}function u(t,e){var n=m.bale(t,e);return m.foreach(t,function(t,e){n[e]===t&&delete n[e]}),n}var l="0.1",h=Object.prototype,f=[],d=f.slice,p=f.splice,v=function(){return this||(0,eval)("this")}(),m={};m.extend=function(t){var e=d.call(arguments);if(e.length>1)m.compose(t,e[1],e[2]);else for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n]);return t},m.define=function(t,e,n){return m.isObject(e)?Object.defineProperties(t,e):Object.defineProperty(t,e,n)},m.isObject=function(t){return"function"==typeof t||"object"==typeof t&&!!t};var _=["Array","Arguments","Boolean","Function","String","Number","Null","Date","RegExp","NodeList","Undefined","HTMLCollection"];_.forEach(function(t,e){m["is"+t]=function(e){return h.toString.call(e)==="[object "+t+"]"}}),m.extend({NULL:function(){},cool:function(t){return t},root:v,broken:{},version:l,foreach:function(n,i,r){if(null!=n){if(this.isArray(n))return t(n,i,r);if(m.isObject(n)&&!m.isFunction(n))return e(n,i,r)}return n},loop:function(){return this.foreach.apply(this,m.slice(arguments))},keys:function(t){if(null!==t)return m.isArray(t)?Object.keys(t).map(function(t){return+t}):Object.keys(t)},slice:function(t){return null!=t?d.call(t):[]},splice:function(t,e,n){return m.isArray(t)?p.call(t,e,n||1):delete t[e],t},pop:function(t){return m.isArray(t)?t.pop():t},shift:function(t){return m.isArray(t)?t.shift():t},push:function(t){return m.isArray(t)&&t.push.apply(t,d.call(arguments,1)),t},unshift:function(t){return m.isArray(t)&&t.unshift.apply(t,d.call(arguments,1)),t},clone:function(t){return m.isArray(t)?d.call(t):m.isObject(t)&&!m.isFunction(t)?JSON.parse(JSON.stringify(t)):t},clonedoom:function(t){if(m.isArray(t)||m.isArguments(t)||m.isNodeList(t)||m.isHTMLCollection(t))return d.call(t);if(m.isObject(t)&&!m.isFunction(t)){var e=function(){};e.prototype=t.constructor.prototype;var n=new e;return m.foreach(t,function(t,e){m.isString(t)||m.isNumber(t)||m.isFunction(t)?n[e]=t:n[e]=m.clonedoom(t)}),n}return t},sort:function(t,e){return m.isArray(t)?t.sort(e):t},unique:function(t){for(var e=0,n=t.length;e<n;e++)if(e!==t.length-1)for(var i=e+1;i<t.length;i++)t[e]===t[i]&&t.splice(i--,1);return t},find:function(){return this.filter.apply(this,m.slice(arguments))},filter:function(t,e,n){var i=[];return m.foreach(m.clonedoom(t),function(t,i){e.call(this,t,i,this)&&!n&&this.push(t)},i),i},reject:function(t,e){var n=[];return m.foreach(m.clonedoom(t),function(t,n){e.call(this,t,n,this)||this.push(t)},n),n},map:function(t,e){return m.foreach(t,function(t,n){this[n]=e.call(this,t,n,this)},t)},cat:function(t,e){var n=[];if(m.isArray(t))for(var i=0,r=t.length;i<r;i++)e.call(t,t[i],i,t)&&n.push(t.splice(i,1).pop())&&i--;else if(m.isObject(t))for(var i in t)if(t.hasOwnProperty(i)&&e.call(t,t[i],i,t)){var o={};o[i]=t[i],n.push(o),delete t[i]}return n},findindex:function(t,e){var n=[];return m.foreach(t,function(t,n){e.call(this,t,n,this)&&this.push(n)},n),n},hook:function(t,e){var n=d.call(arguments,2),i=m.isFunction(e);return this.map(t,function(t){return(i?e:t[e]).apply(t,n)})},bind:function(t){var e=d.call(arguments,1);return m.foreach(t,function(n,i){this.isFunction(n)&&(t[i]=Function.bind.apply(n,e))},this),t},reverse:function(t){return m.isArray(t)?this.slice(t).reverse():t},pluck:function(t,e){var n=[];return m.foreach(t,function(t){for(var n=m.keys(t),i=n.length;i--;)n[i]===e+""&&this.push(t[n[i]])},n),n},groupby:function(t,e){if(m.isArray(t)){var n={},i=m.isFunction(e);return m.foreach(t,function(t){var n=i?e(t):t[e];this[n]?this.hasOwnProperty(n)&&this[n].push(t):this[n]=[t]},n),n}return t},toarray:function(t){for(var e=m.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i},forarray:function(t){for(var e=m.keys(t),n=e.length,i=Array(n),r=0;r<n;r++){var o={};o[e[r]]=t[e[r]],i[r]=o}return i},pairs:function(t){for(var e=[],n=m.keys(t),i=0,r=n.length;i<r;i++)e.push([n[i],t[n[i]]]);return e},random:function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},compose:function(t,e,n){return n?m.foreach(e,function(e,i){var r=this.isArray(n)?!this.has(n,i):null==n||i!==n;r&&(t[i]=e)},this):m.foreach(e,function(e,n){t[n]=e}),t},has:function(t,e){var n=0;return m.foreach(t,function(t){t===e&&(n=1)}),!!n},not:function(t,e){for(var n=0,i=t.length;n<i;n++)m.isequal(t[n],e)&&m.splice(t,n--);return t},bale:function(t,e,n){return m.isArray(t)&&m.isArray(e)?[].concat(t).concat(e):m.compose(m.clonedoom(t),m.clonedoom(e),n)},shuffle:function(t){for(var e,n=m.isArray(t)?t:m.toarray(t),i=n.length,r=Array(i),o=0;o<i;o++)e=m.random(0,o),e!==o&&(r[o]=r[e]),r[e]=n[o];return r},trim:function(t){return t.replace(/^\s+|\s+$/gm,"")},merge:function(){var t=[],e=d.call(arguments);return e.forEach(function(e){t=t.concat(e)}),this.unique(t)},partial:function(t){var e=d.call(arguments,1);return function(){for(var n=0,i=e.slice(),r=0,o=i.length;r<o;r++)i[r]===m&&(i[r]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return t.apply(this,i)}},before:function(t,e){var n;return function(){return--t>0?n=e.apply(this,arguments):e=null,n}},part:function(t,e){var n=m.partial(m.before,(parseInt(e)||1)+1);return n(t)},once:function(t){return m.part(t,1)},isequal:function(t,e,n){if(n||null==t||null==e||m.isFunction(t)||m.isFunction(e)||t===e)return t===e;if(m.typeof(t)!==m.typeof(e))return!1;if(t.toString()===e.toString()){if(m.isArray(t)){if(t.length===e.length){for(var i=t.length;i--;)if(t[i]!==e[i])return!1;return!0}return!1}if(m.isObject(t)){var r=m.keys(t),o=m.keys(e);if(r.length===o.length){for(var i=r.length;i--;)if(t[r[i]]!==e[r[i]])return!1;return!0}return!1}}return!1},typeof:function(t){var e,n=[m.isArray(t),m.isArguments(t),m.isBoolean(t),m.isFunction(t),m.isString(t),m.isNumber(t),m.isNull(t),m.isDate(t),m.isRegExp(t),m.isNodeList(t),m.isUndefined(t),m.isHTMLCollection(t)];return e=m.findindex(n,function(t){return t===!0}).shift(),null==e?"object":_[e].toLowerCase()},requery:function(t){var e={};return m.foreach(t,function(t){e[t.name]=t.value}),e},async:function(t,e){return setTimeout(t,e||0)},combom:function(t,e){for(var n,i=0,r=t.length;i<r;i++)if(e.call(t,t[i],i,t)){n=t[i];break}return n}});var g=/[\t\r\n\f\x20]/g;m.extend({paramparse:function(t){var e,i,r=t.indexOf("?"),o=/([^&=]+)=?([^&]*)/g,a={};for(e=r===-1?t:t.substr(r+1);i=o.exec(e);)a[n(i[1])]=n(i[2]);return a},paramstringify:function(t){var e=m.clone(t);for(var n in e)e[n]=i(m.isObject(e[n])||m.isArray(e[n])?JSON.stringify(e[n]):e[n]);var r=JSON.stringify(e);return r.replace(/[\"\{\}]/g,"").replace(/:/g,"=").replace(/,/g,"&").replace(g,"")},stringparse:function(t){return m.isBoolean(t)?t:t+""}});var y={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"$quot;","'":"&#x27;","`":"&#x60"},b={"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#x27;":"'","&#x60;":"`"},x="(.)^",L=/\\|'|\r|\n|\u2028|\u2029/g,E={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};m.doomSetting={escape:"{{-([\\s\\S]+?)}}",interpolate:"{{#([\\s\\S]+?)}}",evaluate:"{{([\\s\\S]+?)}}"};if(m.extend({encodeHTML:function(t){return+t===t?t:t.replace(/[&<">'](?:(amp|lt|quot|gt|#39);)?/g,r)},decodeHTML:function(t){return+t===t?t:t.replace(/&((g|l|quo)t|amp|#39);/g,o)},doom:function(t,e){var n=0,i="_p+='",r=d.call(arguments,2),o=RegExp((this.doomSetting.escape||x)+"|"+(this.doomSetting.interpolate||x)+"|"+(this.doomSetting.evaluate||x)+"|$","g");t.replace(o,function(e,r,o,s,c){return i+=t.slice(n,c).replace(L,a),n=c+e.length,r?i+="'+\n((_t=("+r+"))==null?'':_.encodeHTML(_t))+\n'":o?i+="'+\n((_t=("+o+"))==null?'':_t)+\n'":s&&(i+="';\n"+s+"\n_p+='"),e}),i+="';\n",e||(i="with(_x||{}){\n"+i+"}\n"),i="var _t,_p='';\n"+i+"return _p;\n";try{var s=(0,eval)("(function("+(e||"_x")+",_"+(r.length?","+r.toString():"")+"){"+i+"})")}catch(t){throw t.res=i,console.log(i),t}return function(t){return s.apply(this,[t,m].concat(d.call(arguments,1)))}}}),m.extend({watch:function(t,e,n){function i(){return a}function r(i){return o=a,a=n.call(t,i,o,e)}var o=t[e],a=o;return delete t[e]&&(Object.defineProperty?Object.defineProperty(t,e,{get:i,set:r,enumerable:!0,configurable:!0}):Object.prototype.__defineGetter__&&Object.prototype.__defineSetter__&&(Object.prototype.__defineGetter__.call(t,e,i),Object.prototype.__defineSetter__.call(t,e,r))),t},unwatch:function(t,e){var n=t[e];return delete t[e],t[e]=n,t}}),m.extend({addEvent:function(t,e,n){return t._events||m.define(t,"_events",{value:{},writable:!0,enumerable:!1,configurable:!0}),t._events[e]||(t._events[e]=[]),m.has(t._events[e],n)||t._events[e].push(n),t},removeEvent:function(t,e,n){if(t._events[e])m.not(t._events[e],n),t._events[e].length&&n||delete t._events[e];else if(!e&&!n)return m.release(t);return t},release:function(t){return delete t._events,t},dispatch:function(t,e,n,i){var r=m.isFunction(n);return t._events&&t._events[e]&&(r?m.foreach(t._events[e],function(e){e===n&&e.apply(t,i||[])}):m.foreach(t._events[e],function(e){e.apply(t,i||[])})),t},trigger:function(){return m.dispatch(m.slice(arguments))}}),m.root.self){var T=function(t){this.info=t.userAgent,this.language=t.language,this.platform=t.platform};m.extend(T.prototype,{defineBroswer:function(t,e){var n=this.info;this.browser={};for(var i=t.length;i--;)e[i].call(n,m.root)?this.browser[t[i]]=!0:this.browser[t[i]]=!1;return this},definePlatform:function(t,e){var n=this.info;this.version={};for(var i=t.length;i--;)this.version[t[i]]=e[i].call(n,m.root);return this}});var O=new T(m.root.navigator).defineBroswer(["IE","Edge","Opera","Chrome","Safari","FireFox","Mobile","Desktop"],[function(){return/(Trident|MSIE)/i.test(this)},function(){return/Edge/i.test(this)&&/Webkit/i.test(this)},function(){return/Opera/i.test(this)&&/Webkit/i.test(this)},function(t){return null!=t.chrome},function(){return/Safari/i.test(this)&&!/Chrome/i.test(this)},function(t){return/Firefox/i.test(this)&&t.netscape&&/Gecko/.test(this)},function(t){return t.devicePixelRatio>1},function(t){return null==t.devicePixelRatio||1===t.devicePixelRatio}]).definePlatform(["OS","RenderEnginner","Chrome","Firefox","IE"],[function(t){return/Windows/gi.test(this)?"Windows":/(Linux|Ubuntu|CentOS|Debian|Arach|RedHat|FreeBSD|Unix)/gi.test(this)?"Linux":/Macintosh/gi.test(this)?"Mac OS X":/iOS|iPad|iPhone/gi.test(this)?"iOS":/Android/gi.test(this)?"Android":"UnKown"},function(t){return/(Webkit|Gecko|Trident)/gi.exec(this)[0]},function(t){return!!/Chrome/gi.test(this)&&this.match(/(Chrome)\/([\d\.]+)/gi)[0].replace(/[^\d\.]/gi,"")},function(t){return!!/Firefox/gi.test(this)&&/Firefox\/([\d\.]+)/gi.exec(this)[1]},function(t){return!!/IE/gi.test(this)&&parseInt(/MSIE\ ([\d\.]+)/gi.exec(this)[1])}]),S=0,A=m.root.localStorage;A.getItem("aixcache")||A.setItem("aixcache","{}");var w=/<(\/)?(\w+)\s?([^>]+?)?\>{1}/gi,N=/([^<>\s]+)=[\'\"]?([^>\'\"]+)[\'\"]?\s/gi,F=function(t,e){var n={};return t=" "+(t||"")+" ",t.replace(N,function(t,e,i){return n[e]=i,t}),n["x-aim"]=e,n},$=["input","hr","br","img","area","base","!DOCTYPE","!--"];m.extend({datamime:function(t,e){if(m.isObject(t)&&t["Content-type"])switch(t["Content-type"]){case"application/json":return JSON.stringify(e||{});default:return m.paramstringify(e||{})}return m.paramstringify(e||{})},strip:function(t,e){var n=m.isString(t)?t.replace(/<script\b[^>]*>(.*?)<\/script>/gim,""):"";return e?n.replace(/[\t\r\n\f]/gm,""):n},domparse:function(t){var e=m.trim(m.strip(t)),n=1,i=1,r=[],o=[],a=1;e.replace(w,function(t,e,s,c,u){var l={};l["@"]=a++;var h;if("/"!==e){h=n++,null==r[h]&&(r[h]=[]);h-i++;m.compose(l,{tagname:s,attributes:F(m.trim(c||""),l["@"]),$ob:u+t.length}),r[h].push(l),m.has($,s)?(--n,--i,l.$oe=0):o.push(l)}else{h=--n,--i,--a;var f=o.pop();f.$oe=u-f.$ob}return t});for(var s=1,c=r.length;s<c;s++)for(var u=r[s],l=r[s+1],h=r[s-1],f=0,d=u.length;f<d;f++){var p=u[f].$ob,v=u[f].$oe,_=null;u[f].content=m.trim(e.substr(p,v)),l&&(_=m.filter(l,function(t,e){return t.$ob>p&&t.$ob+t.$oe<p+v}),0===_.length&&(_=null)),u[f].child=_,u[f].parent=h?m.combom(h,function(t,e){return p>t.$ob&&p+v<t.$ob+t.$oe}):null}return r},virtualDOM:function(t){var e=m.domparse(t||""),n=c(e);return n.xdom=e,n.xbase=t,n.xhtml=n.innerHTML,n},virtualDIFF:function(t,e){var n=[],i=[],r=t.xdom,o=e.xdom;if(m.strip(t.xhtml)===m.strip(e.xhtml))return n;if(r.length&&o.length)for(var a=1,s=Math.max(r.length,o.length);a<s;a++)for(var c=r[a]||[],l=o[a]||[],h=0,f=Math.max(c.length,l.length);h<f;h++){var d=c[h],p=l[h],v=null!=d,_=null!=p;v&&_?d.tagname!==p.tagname?(n.push({type:"replace",aim:d["@"],root:!0,content:e.querySelector("[x-aim='"+p["@"]+"']")}),i.push(d["@"])):(m.isequal(d.attributes,p.attributes)||n.push({type:"props",aim:d["@"],props:u(d.attributes,p.attributes)}),d.child||p.child||d.content!==p.content&&n.push({type:"text",aim:d["@"],content:p.content})):v&&!_?n.push({type:"remove",aim:d["@"]}):!v&&_&&n.push({type:"append",aim:m.isObject(p)&&null!=p.parent?p.parent["@"]:"root",content:e.querySelector("[x-aim='"+p["@"]+"']")})}else{if(0===r.length)return n.push({type:"create",aim:"root",content:e.innerHTML}),n;if(0===o.length)return n.push({type:"destory",aim:"root"}),n}n=m.filter(n,function(t){return t.root||!m.has(i,t.aim)});for(var a=0,g=n.length;a<g;a++)"remove"===n[a].type?n.unshift(n.splice(a,1).pop()):"replace"===n[a].type&&n.push(n.splice(a,1).pop());return n},cookieparse:function(t){var e,n={},i=t?t.split(";"):[];return i.forEach(function(t){e=(t||"").split("="),e.length&&(n[m.trim(e[0])]=m.trim(e[1]))}),n},cookie:function(t){var e=m.slice(arguments),n=e.length,i=m.cookieparse(m.root.document.cookie);if(n){if(1===n)return i[t];var r=new Date;return r.setDate(r.getDate()+365),m.root.document.cookie=m.trim(e[0]+"="+(e[1]||"")+";expires="+(e[2]||r.toGMTString())+";path="+(e[3]||"/")+";domain="+(e[4]||"")+";"+(e[5]?"secure":""))}return i},aix:function(t){var e=m.compose({url:"",type:"GET",param:m.broken,charset:"utf-8",aysnc:!0,vaild:!0,cache:!1,success:m.NULL,fail:m.NULL,loading:null,loaded:null,header:m.broken,username:null,password:null,timeout:0},t||{});if(e.cache){var n=JSON.parse(A.getItem("aixcache")),i=e.url||m.root.location.href.split("#")[0];if(n[i])return e.success.call(m.root,n[i])}var r=new XMLHttpRequest;if("GET"===e.type.toUpperCase()&&e.param&&(e.url+=(e.url.search(/\?/g)===-1?m.keys(e.param).length?"?":"":"&")+m.paramstringify(e.param),e.param=null),m.isFunction(e.loading)){var o=function(t){e.loading.call(m.root,t)};r.addEventListener("loadstart",function(t){o(t),r.removeEventListener("loadstart",o),o=null})}if(m.isFunction(e.loaded)){var a=function(t){e.loaded.call(m.root,t)};r.addEventListener("loadend",function(t){a(t),r.removeEventListener("loadend",a),a=null})}if(null!=e.username?r.open(e.type,e.url,e.aysnc,e.username,e.password||""):r.open(e.type,e.url,e.aysnc),"POST"===e.type&&e.param&&!e.header["Content-type"]&&r.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset="+e.charset),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Aix-Requested","AixHttpRequest"),m.isObject(e.header)&&e.header!==m.broken){var s=e.header["Content-type"];null!=s&&(s.search("charset")>-1||s.search("json")>-1||(e.header["Content-type"]+=";charset="+e.charset)),m.foreach(e.header,function(t,e){r.setRequestHeader(e,t)})}return r.onreadystatechange=function(t){if(4===r.readyState&&r.responseText){var n=r.status;if(n>=200&&n<300||304===n){if(e.success.call(m.root,r.responseText,r,t),e.cache){var i=JSON.parse(A.getItem("aixcache"));i[e.url||m.root.location.href.split("#")[0]]=r.responseText,A.setItem("aixcache",JSON.stringify(i))}}else e.fail.call(m.root,r,t)}},r.send(e.param?m.isObject(e.param)?m.datamime(e.header,e.param):e.param:null),S++,e.timeout&&m.async(function(){r.abort(),e.fail.call(m.root,r)},1e3*e.timeout||5e3),r},aixp:function(t){var e=m.compose({url:"",param:m.broken,key:"callback",fn:("jsonp"+Math.random()).replace(".",""),timeout:5,success:m.NULL,fail:m.NULL},t||{}),n=e.url+"?"+m.paramstringify(e.param)+(m.keys(e.param).length?"&":"")+e.key+"="+e.fn,i=m.root.document.createElement("script");i.src=n,m.root[e.fn]=function(t){clearTimeout(e.timesetup),m.root.document.body.removeChild(i),m.root[e.fn]=null,e.success.call(m.root,t)},m.root.document.body.append(i),e.timeout&&(e.timesetup=setTimeout(function(){m.root.document.body.removeChild(i),m.root[e.fn]=null,e.success.call(m.root)},1e3*e.timeout)),S++},pagepref:function(){var t=m.slice(document.getElementsByTagName("*")),e="",n={},i="",r={},o="",a="",s=m.slice(document.getElementsByTagName("img")),c=[],u=m.slice(document.getElementsByTagName("script")),l=function(t,e,n){t[n]?t[n].push(e):t[n]=[e]};m.foreach(t,function(t){var s=t.getAttribute("class");s&&(i+=" "+s,s=m.trim(s).split(" "),m.foreach(s,function(e){l(r,t,e)})),s=t.getAttribute("id"),s&&(e+=" "+s,s=m.trim(s),l(n,t,s)),s=m.root.getComputedStyle(t),s&&s.backgroundImage&&"none"!==s.backgroundImage.toLowerCase()&&(a+=" "+s.backgroundImage),s=t.getAttribute("href"),s&&(o+=" "+s)}),m.foreach(s,function(t){var e=t.getAttribute("src");e&&(a+=" "+e)}),m.foreach(u,function(t){var e=t.getAttribute("src");e&&c.push(e.split("/").pop().slice(0,-3))});var h=e.split(" ");h.shift(),h=m.unique(h);var f=i.split(" ");f.shift(),f=m.unique(f);var d=a.split(" ");d.shift(),d=m.unique(d);var p=o.split(" ");return p.shift(),p=m.unique(p),{_url:window.location.href,htmlsize:(document.body.innerHTML+document.head.innerHTML).replace(g,"").length,htmltags:t.length,idlist:h.sort(),idchecker:n,classlist:f.sort(),classchecker:r,scriptlist:c,imglist:d.sort(),linklist:p.sort(),cookies:m.cookie(),localstorage:A||{},_aixxhr:S}},ua:O})}var U;m.stack=U=function(t){var e=t||[],n=[];m.foreach(e,function(t){var e=m.isObject(t)?m.toarray(t):t||[],i=m.isFunction(e[0])?e[0]:m.NULL,r=m.isNumber(e[1])?e[1]:0,o=function(t){setTimeout(function(){var e=n.pop(),r=i.call(m.root,t);e&&e.call(m.root,r)},1e3*r)};n.push(o)}),m.define(this,"=",{value:n,writable:!0,enumerable:!1,configurable:!1})},m.extend(U.prototype,{noop:function(){return this["="]=[],this},fire:function(){return this["="].length&&this["="].pop().call(m.root)},add:function(){return this.push.apply(this,m.slice(arguments))},push:function(){var t=this,e=m.slice(arguments);m.foreach(e,function(e){if(!m.isFunction(e)&&!m.isArray(e))return console.error("add/push arguments error when assign to stack!");var n=m.isArray(e)?e[0]:e,i=m.isArray(e)?e[1]||0:parseFloat(e||0),r=function(e){setTimeout(function(){var i=t["="].pop(),r=n.call(m.root,e);i&&i.call(m.root,r)},1e3*i)};t["="].push(r)})}});var k;return m.hack=k=function(t,e){var n=this,i=t||[],r=i.length,o=new Array(r),a=[];m.define(this,{complete:{value:e||m.NULL,writable:!0,enumerable:!1,configurable:!1},"-":{value:a,writable:!0,enumerable:!1,configurable:!1}}),m.foreach(i,function(t,e){var i=e,r=m.isObject(t)?m.toarray(t):t||[],s=m.isFunction(r[0])?r[0]:m.NULL,c=m.isNumber(r[1])?r[1]:0,u=function(){setTimeout(function(){var t=s();o[i]=t||1,m.has(o)||(n.complete.apply(m.root,o),n.noop())},1e3*c)};a.push(u)})},m.extend(k.prototype,{noop:function(){return this["-"]=null,this.complete=null,this},fire:function(){return this["-"].length?m.foreach(this["-"],function(t){return t.call(m.root)}):0}}),m}),function(t,e){"function"==typeof define&&define.amd?define(["_"],e):t.__=e(_)}(this,function(t){"use strict";function e(){h||(h=!0,d.forEach(function(e,n){e.fn.call(t.root,e.ct)}),d=[])}function n(t){p.length>=v.config.limit&&p.shift(),p.push(t)}function i(e){return e.$el.every(function(e){return t.ua.browser.IE?document.body.contains(e):document.contains(e)})}function r(e){e=t.strip(t.trim(e));var n=[],i=!b.test(e),o=!x.test(e);if(i&&o)if(e.search(",")>-1)t.foreach(e.split(","),function(t){n=n.concat(r(t))});else{if(m.test(e))return[document.getElementById(e.substr(1))];if(_.test(e))n=document.getElementsByClassName(e.substr(1));else if(g.test(e))n=document.getElementsByTagName(e);else{if(y.test(e)){var a=y.exec(e),s=a[1],c=a[2],u=a[3];return null==s?t.slice(document.getElementsByTagName("*")).filter(function(t){return t.getAttribute(c)===u}):r(s).filter(function(t){return t.getAttribute(c)===u})}if(L.test(e)){var l=document.createElement("i");return l.innerHTML=e,n=t.slice(l.childNodes),n.filter(function(t){return 1===t.nodeType})}n=document.querySelectorAll(e)}}else{if(L.test(e)){var l=document.createElement("i");return l.innerHTML=e,n=t.slice(l.childNodes),n.filter(function(t){return 1===t.nodeType})}n=document.querySelectorAll(e)}return t.slice(n)}function o(t){if(t.search("rgb")!=-1){var e=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+s(e[1])+s(e[2])+s(e[3])}return t}function a(t){if(t.search("-")!=-1){for(var e=t.split("-"),n=1,i=e.length;n<i;n++)e[n]=e[n].charAt(0).toUpperCase()+e[n].slice(1);return e.join("")}return t}function s(t){return("0"+parseInt(t).toString(16)).slice(-2)}function c(t){if(null==t)return t;var e=t.nextSibling;return null!=e&&1===e.nodeType?e:c(e)}function u(e,n,i,r){var o,a=t.isObject(r)?r:new CustomEvent(n,{data:i,bubbles:!0,cancelable:!0,target:e,toElement:e,srcElement:e,currentTarget:e});return t.isObject(r)&&(o={},o.data=i),null!=o?new O.Events(a,o):a}function l(e){var n=this;switch(e.type){case"props":t.foreach(e.props,function(t,e){n.attr(e,t)});break;case"remove":n.remove();break;case"text":n.text(e.content);break;case"append":n.append(e.content.cloneNode(!0));break;case"create":n.fill(e.content);break;case"replace":n.replacewith(e.content);break;case"destory":n.empty()}}var h=!1,f=!1,d=[],p=[],v=function(n,r){if(t.isFunction(n))return h?setTimeout(function(){n(r)},0):(d.push({fn:n,ct:r}),"complete"===document.readyState?setTimeout(e,0):f||document.addEventListener("DOMContentLoaded",e,!1),void(f=!0));if(n instanceof E)return n;if(t.isString(n)){var o;if(p.forEach(function(t){t.$indicator===n&&(o=t)}),null!=o&&i(o))return t.clonedoom(o)}return new E(n)};v.config={limit:4,version:t.version};var m=/^#[^\s\=\+\.\#\[\]]+/i,_=/^\.[^\s\=\+\.\#\[\]]+$/i,g=/^[^\[\]\+\-\.#\s\=]+$/i,y=/([^\s]+)?\[([^\s]+)=["']?([^\s'"]+)["']?\]$/i,b=/[\s|\r]+/im,x=/[>|\+|\~]+/im,L=/\<[a-zA-Z][\s\S]*\>/,E=function(e){this.$el=[],null!=e&&(t.isString(e)?(this.$el=r(e),this.$indicator=e):e!==document&&e!==t.root&&1!==e.nodeType||(this.$el.push(e),this.$indicator="")),this.length=this.$el.length,n(t.clonedoom(this))};v.fn=E.prototype={constructor:E,version:t.version,extend:function(e){t.extend(this,e)}},v.fn.extend({each:function(e,n){return t.foreach(this.$el,e,n||this),this},get:function(e){return this.$el[+e+(e<0?this.length:0)]||t.slice(this.$el)},at:function(e){if(this.length){var n=t.clonedoom(this);return e=+e+(e<0?n.length:0),n.$el=[n.$el[e]],n.$el.length=1,n}return this},first:function(){return this.at(0)},last:function(){return this.at(-1)},add:function(){return this.compose.apply(this,t.slice(arguments))},compose:function(e){return null!=e&&(e instanceof E?this.$el=t.unique(this.$el.concat(e.$el||[])):t.isString(e)&&(this.$el=t.unique(this.$el.concat(v(e).$el)))),this.length=this.$el.length,this},by:function(e){var n=t.clonedoom(this);return n.$el=n.$el.filter(e),n.length=n.$el.length,n},even:function(){return this.by(function(t,e){return e%2!=0})},odd:function(){return this.by(function(t,e){return e%2==0})},next:function(e){var n=t.clonedoom(this),i=[],r=e?"previousElementSibling":"nextElementSibling";return t.foreach(n.$el,function(t){null!=t[r]&&i.push(t[r])}),n.$el=t.filter(i,function(t){return 3!==t.nodeType&&8!==t.nodeType&&"SCRIPT"!==t.nodeName}),n.length=n.$el.length,n},prev:function(t){return this.next(!t)},find:function(e){var n=t.clonedoom(this),i=[];return t.foreach(n.$el,function(n){i=t.slice(n.querySelectorAll(e)).concat(i)}),n.$el=i,n.length=n.$el.length,n},siblings:function(){var e=t.clonedoom(this),n=[],i=e.$el;return t.foreach(e.$el,function(e){n=t.slice(e.parentNode.children).concat(n)}),e.$el=t.filter(t.unique(n),function(e){return!t.has(i,e)}),e.length=e.$el.length,e},childrens:function(){var e=t.clonedoom(this),n=[];return t.foreach(e.$el,function(e){n=t.slice(e.children).concat(n)}),e.$el=t.unique(n),e.length=e.$el.length,e},parents:function(){var e=t.clonedoom(this),n=[];return t.foreach(e.$el,function(t){for(var e=[],i=t;i;)e.push(i.parentNode),i=i.parentNode;n=n.concat(e)}),e.$el=t.unique(n),e.length=e.$el.length,e}});var T=["checked","disabled","readonly","required","validate"];v.fn.extend({addClass:function(e){return this.each(function(n){var i=n.getAttribute("class");i?(i=i.split(" "),n.setAttribute("class",t.unique(i.concat(e.split(" "))).join(" "))):n.setAttribute("class",t.unique(e.split(" ")).join(" "))})},removeClass:function(e){return this.each(function(n){var i=n.getAttribute("class");i&&(i=i.split(" "),t.foreach(e.split(" "),function(e){t.not(i,e)}),n.setAttribute("class",i.join(" ")))})},toggleClass:function(e){return this.each(function(n){var i=n.getAttribute("class");i?(i=i.split(" "),t.foreach(t.unique(e.split(" ")),function(e){t.has(i,e)?t.not(i,e):i.push(e)}),n.setAttribute("class",i.join(" "))):n.setAttribute("class",e)})},attr:function(){var e=t.slice(arguments);if(e.length){if(1===e.length)return this.get(0).getAttribute(e[0]);this.each(function(t){t.setAttribute(e[0],null!=e[1]?e[1].toString():"")})}return this},removeAttr:function(t){return this.each(function(e){e.removeAttribute(t)})},data:function(){var e=t.slice(arguments);return e[0]?(e[0]="data-"+e[0],this.attr.apply(this,e)):this},prop:function(){var e=t.slice(arguments);return e.length?1===e.length?t[t.has(T,e[0])?"isString":"cool"](this.attr(e[0])):e[1]!==!1&&0!==e[1]?this.attr(e[0],t.has(T,e[0])?"":e[1]):this.removeAttr(e[0]):this},removeProp:function(t){return this.removeAttr(t)},value:function(e){if(t.slice(arguments).length)return this.each(function(n){var i=n.tagName.toUpperCase();"SELECT"===i?t.foreach(t.slice(n.options),function(t){t.removeAttribute("selected"),(t.getAttribute("value")||t.innerText)===e+""&&t.setAttribute("selected","")}):n.setAttribute("value",e)});var n=this.get(0);return"SELECT"===n.tagName.toUpperCase()?n.options[n.selectedIndex].value||n.innerText:n.value||""},text:function(e){return null!=e?this.each(function(t){t.innerText=e+""}):t.decodeHTML(this.get(0).innerText||"")},fill:function(e){if(null!=e){var n="";return e.nodeType&&1===e.nodeType?n=e.outerHTML:t.isObject(e)&&e instanceof E?e.each(function(t){n+=t.outerHTML}):n=e+"",this.each(function(t){null!=t&&(t.innerHTML=n+"")})}var i=this.get(0);return null!=i.innerHTML?i.innerHTML:""},html:function(){return this.fill.apply(this,t.slice(arguments))},replacewith:function(t){var e=v(t);return this.each(function(t){e.each(function(e){t.parentNode.insertBefore(e,t)}),t.parentNode.removeChild(t)}),e},insertbefore:function(t){var e=v(t);return this.each(function(t){e.each(function(e){t.parentNode.insertBefore(e,t)})})},insertafter:function(t){var e=v(t);return this.each(function(t){e.each(function(e){var n=c(t);null!=n?t.parentNode.insertBefore(e,n):t.parentNode.appendChild(e)})})},append:function(t){var e=v(t);return this.each(function(t){e.each(function(e){t.appendChild(e)})})},remove:function(){return this.off().each(function(t){t.parentNode.removeChild(t)}),this.$el=[],this.length=0,this},empty:function(){return this.each(function(t){t.innerHTML=""})},offset:function(){var t=0,e=0,n=0,i=0,r=this.get(0);for(n=r.offsetWidth,i=r.offsetHeight;r;)e+=r.offsetLeft,t+=r.offsetTop,r=r.offsetParent;return{top:t,left:e,witdh:n,height:i}},pos:function(){var t=this.get(0);return{top:t.offsetTop,left:t.offsetLeft,width:t.offsetWidth,height:t.offsetHeight}},draw:function(e,n){if(t.isString(e))return null==n?o(window.getComputedStyle(this.get(0),null)[e]):this.each(function(t){t.style[a(e)]=(n||"")+""});if(t.isObject(e))for(var i in e)this.draw(i,e[i]);return this},css:function(){return this.draw.apply(this,t.slice(arguments))},redraw:function(){return this.removeAttr("style")}});var O={};return O.Events=function(e,n){for(var i in e)t.isFunction(e[i])||i===i.toUpperCase()||(this[i]=e[i]);this.data=n.data,t.define(this,"_event",{value:e,writable:!1,enumerable:!1,configurable:!0})},O.Events.consoda=["stopImmediatePropagation","stopPropagation","preventDefault"],O.Events.consoda.forEach(function(t){O.Events.prototype[t]=function(){return this._event[t]()}}),v.fn.extend({reg:function(e,n,i,r,o){return t.isFunction(n)&&(o=r,r=i,i=n,n=null),this.each(function(a){if(null==a._events&&t.define(a,"_events",{value:{},writable:!0,enumerable:!1,configurable:!0}),null!=i){var s=function(t){var o=u(a,e,n,t);i.call(r||a,o,e,r)};s.fn=i.fn||i,s.cal=i,null==a._events[e]&&(a._events[e]=[]),a._events[e].push(s),a.addEventListener(e,s,!!o)}})},purge:function(e,n){return this.each(function(i){t.isString(e)?null!=n?(null!=i._events[e]?(i.removeEventListener(e,t.cat(i._events[e],function(t){return t.fn===n})[0]||n),i._events[e].length||delete i._events[e]):i.removeEventListener(e,n),null!=i._events["_"+e]&&(document.documentElement.removeEventListener(e,t.cat(i._events["_"+e],function(t){return t.fn===n})[0].cal,!0),i._events["_"+e].length||delete i._events["_"+e])):null!=i._events&&(t.foreach(i._events[e],function(t){i.removeEventListener(e,t)}),t.foreach(i._events["_"+e],function(t){document.documentElement.removeEventListener(e,t.cal,!0)}),delete i._events["_"+e],delete i._events[e]):(i._events=i._events||{},t.foreach(i._events,function(e,n){n.search("_")!==-1?t.foreach(e,function(t){document.documentElement.removeEventListener(n.slice(1),t.cal,!0)}):t.foreach(e,function(t){i.removeEventListener(n,t)})}))})},live:function(e,n,i,r,o){var a,s=!t.isFunction(n);return t.isFunction(i)||(a=i,i=t.isFunction(r)?r:t.NULL,r=o),this.each(function(r){if(s){var o=function(o){for(var s,c=v(o.target||o.toElement),l=c.parents().add(c).get(),h=v(r).find(n).get(),f=0,d=h.length;f<d;f++)if(t.has(l,h[f])){s=h[f];break}if(s&&1===s.nodeType)return i.call(s,u(c.get(0),e,a,o),e)};o.fn=i,o.elm=r,v(r).reg("_"+e,o,null),document.documentElement.addEventListener(e,o,!0)}else v(r).reg(e,n,i)})},on:function(){return this.live.apply(this,t.slice(arguments))},off:function(t,e,n){return this.purge(t,n)},signet:function(e,n){return null!=e?null!=n?this.each(function(i){i[e]?i.name=n:t.define(i,e,{value:n,writable:!0,enumerable:!1,configurable:!0})}):this.get(0)[e]:this},once:function(e,n,i,r){return t.isFunction(n)&&(r=i,i=n,n=null),this.each(function(t){var r=function(o){i.call(t,u(t,e,n,o),e),t.removeEventListener(e,r),r=null};t.addEventListener(e,r)})},dispatch:function(e,n){return this.each(function(i){var r=u(i,e);return t.isFunction(n)?n.call(i,r):i.dispatchEvent(r)})}}),v.fn.extend({xInit:function(){return this.each(function(e){e.innerHTML=t.virtualDOM(e.innerHTML).innerHTML})},xRender:function(e,n,i){return this.each(function(r){var o=t.virtualDOM(r.innerHTML),a=t.virtualDOM(e);t.isObject(n)&&(this[i||"@"]=a);var s=t.virtualDIFF(o,a);t.foreach(s,function(t){l.call("root"===t.aim?v(this):v(this).find("[x-aim='"+t.aim+"']"),t)},r)},n)}}),v}),function(t,e){"function"==typeof define&&define.amd?define(["_","__"],e):t.aix=e(_,__)}(this,function(_,$){"use strict";function _genertor_(t){return function(){
var e=_.clonedoom(this.data),n=[e].concat(_.slice(arguments));return e=_[t].apply(e,n),_.isequal(e,this.data)||(this.data=e,this.dispatch(t,null,n)),this}}function _genertor_$(t){return function(){var e=_.clonedoom(this.data),n=[e].concat(_.slice(arguments));return _[t].apply(e,n)}}function _genertor__(t){return function(){var e=_.clonedoom(this.data),n=[e].concat(_.slice(arguments)),i=_[t].apply(e,n);return _.isequal(e,this.data)||(this.data=e,this.dispatch(t,null,n)),i}}function hackaix(t,e){var n=t.toString(),i=t.toString().replace(strip_comment,""),r=e.toString().replace(strip_comment,""),o=n.slice(n.indexOf("{")+1,n.lastIndexOf("}"));return i=i.slice(i.indexOf("(")+1,i.indexOf(")")).match(/([^\s,]+)/g)[0],r=r.slice(r.indexOf("(")+1,r.indexOf(")")).match(/([^\s,]+)/g)[0],[i||"",r||"",o]}function createExtend(origin){return function(def){var x=hackaix(aix[origin],aix[origin].extend),extend=eval("(function(ops){ var "+x[0]+"=_.extend(_.extend({},"+x[1]+"),ops||{}); "+x[2]+"})");return _.compose(extend.prototype,aix[origin].prototype),extend.prototype.constructor=extend,_.define(extend,"base",{value:aix[origin],writable:!1,enumerable:!1,configurable:!1}),extend}}function changeHash(t,e,n){_.foreach(this.routes,function(i,r){RegExp(r,"i").test(t)&&changeHashReg.call(this,i,[n,t,e,r])},this)}function changeHashReg(t,e){switch(_.typeof(t)){case"function":t.apply(this||_.root,e);break;default:_.foreach(_.isString(t)?t.split(","):t,function(t){this.actions[t].apply(this||_.root,e)},this)}}var aix={},AIX_VIEW_COUNT=0,AIX_MODELS_COUNT=0,AIX_COLLECTION_COUNT=0,AIX_VIEW_DEFAULT={el:"",template:""},AIX_ROUTE_DEFAULT={routes:{},actions:{}},AIX_MODELS_DEFAULT={data:""},AIX_COLLECTION_DEFAULT={data:[],model:0},RESTFUL_enable={get:"GET",put:"PUT",save:"POST",post:"POST",pull:"PULL",fetch:"FETCH",update:"UPDATE",delete:"DELETE"},RESTFUL_disable={get:"GET",put:"POST",save:"POST",post:"POST",pull:"POST",fetch:"GET",update:"POST",delete:"POST"},RESTFUL_LIST=RESTFUL_disable;aix.aixpref=function(){return{count:{views:AIX_VIEW_COUNT,models:AIX_MODELS_COUNT,collections:AIX_COLLECTION_COUNT}}},aix.config={restful:!1},_.watch(aix.config,"restful",function(t){return RESTFUL_LIST=t?RESTFUL_enable:RESTFUL_disable,t});var strip_comment=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;aix.model=function(t){t=t||{};var e=this;_.define(this,{aid:{value:"#"+ ++AIX_MODELS_COUNT,writable:!0,enumerable:!1},change:{value:!1,writable:!0,enumerable:!1}}),_.isObject(t.events)&&_.foreach(t.events,function(t,n){_.addEvent(e,n,t)}),_.isFunction(t.validate)&&_.define(e,"validate",{value:t.validate,writable:!1,enumerable:!1,configurable:!1}),delete t.validate,delete t.change,delete t.events,_.extend(e,_.extend(_.clone(AIX_MODELS_DEFAULT),t)),_.watch(e,"data",function(t,n){if(_.isFunction(e.validate)){var i=!0;return(_.isFunction(e.validate)?!e.validate.call(e,t):0)&&(i=!1),i?(_.isequal(t,n)||(_.dispatch(e,"change",null,[t,n]),e.change=!0),_.dispatch(e,"validate",null,[t,n]),_.dispatch(e,"validate:success",null,[t,n]),t):(_.dispatch(e,"validate",null,[t,n]),_.dispatch(e,"validate:fail",null,[t,n]),n)}return _.isequal(t,n)||(_.dispatch(e,"change",null,[t,n]),e.change=!0),t}),_.dispatch(e,"init")},aix.model.prototype={constructor:aix.model,get:function(t){return _.isString(t)||_.isNumber(t)?_.clone(this.data[t]||""):_.clone(this.data)},set:function(){var t=_.slice(arguments);return t.length>1?(this.dispatch("change",null,[t[1],this.data[t[0]]]),this.data[t[0]]=t[1]):this.data=t[0],this.dispatch("set",null,t)},addEvent:function(t,e){return _.isFunction(e)&&_.addEvent(this,t,e),this},removeEvent:function(t,e){return _.removeEvent(this,t,e)},dispatch:function(t,e,n){return _.dispatch(this,t,_.isFunction(e)?e:null,n)},trigger:function(t,e,n){return this.dispatch(t,e,n)},listen:function(t,e){return _.isObject(this.data)&&_.watch(this.data,t,e),this},unlisten:function(t){return _.isObject(this.data)&&_.unwatch(this.data,t),this},add:function(){var t=_.slice(arguments),e=_.clone(this.data),n=_.typeof(e);return _.foreach(t,function(t){switch(n){case"number":e+=_.isNumber(+t)?+t:0;break;case"string":e+=t.toString();break;case"array":e=e.concat(t);break;case"object":_.isObject(t)&&_.extend(e,t)}}),this.data=e,this.dispatch("add",null,t)},remove:function(){var t=_.slice(arguments),e=_.clone(this.data),n=_.typeof(e);return _.foreach(t,function(t){switch(n){case"string":e=e.replace(t.toString,"");break;case"array":_.isArray(t)?_.foreach(t,function(t){_.not(e,t)}):_.not(e,t);break;case"object":_.isArray(t)?_.foreach(t,function(t){delete e[t]}):delete e[t]}}),t.length?this.data=e:this.data=null,this.dispatch("remove",null,t)}},aix.collection=function(t){t=t||{};var e=this;_.define(e,{cid:{value:"#"+ ++AIX_COLLECTION_COUNT,writable:!0,enumerable:!1},change:{value:!1,writable:!0,enumerable:!1}}),_.isObject(t.events)&&_.foreach(t.events,function(t,n){_.addEvent(e,n,t)}),_.isFunction(t.validate)&&_.define(e,"validate",{value:t.validate,writable:!1,enumerable:!1,configurable:!1}),delete t.validate,delete t.change,delete t.events,_.extend(e,_.extend(_.clone(AIX_COLLECTION_DEFAULT),t)),e.model&&(e.data=_.filter(e.data,function(t){return t.constructor===e.model})),_.watch(e,"data",function(t,n){if(_.isArray(t)||(t=[t]),_.isFunction(e.validate)){var i=!0;return _.foreach(t,function(t){(e.model?t.constructor!==e.model:0)&&(i=!1),(_.isFunction(e.validate)?!e.validate.call(e,t):0)&&(i=!1)}),i?(_.isequal(t,n)||(_.dispatch(e,"change",null,[t,n]),e.change=!0),_.dispatch(e,"validate",null,[t,n]),_.dispatch(e,"validate:success",null,[t,n]),t):(_.dispatch(e,"validate",null,[t,n]),_.dispatch(e,"validate:fail",null,[t,n]),n)}return _.isequal(t,n)||(_.dispatch(e,"change",null,[t,n]),e.change=!0),t}),_.dispatch(e,"init")},aix.collection.prototype={constructor:aix.collection,addEvent:function(t,e){return _.isFunction(e)&&_.addEvent(this,t,e),this},removeEvent:function(t,e){return _.removeEvent(this,t,e)},listen:function(t,e){return _.isObject(this.data)&&_.watch(this.data,t,e),this},unlisten:function(t){return _.isObject(this.data)&&_.unwatch(this.data,t),this},add:function(){var t=this.data.length,e=_.slice(arguments),n=_.slice(this.data);return e.length&&(n=n.concat.apply(n,e)),_.isequal(this.data,n)?this:(this.data=n,this.data.length===t?this:this.dispatch("add",null,e))},remove:function(t){var e,n=this.data.length;return _.isString(t)?(e=_.slice(this.data),e=_.cat(e,function(e){return e.aid!=="#"+t})):_.isObject(t)&&(_.isFunction(this.model)?t instanceof this.model&&(e=_.slice(this.data),e=_.not(e,t)):(e=_.slice(this.data),e=_.not(e,t))),e?(this.data=e,this.data.length===n?this:this.dispatch("remove",null,[t])):this},get:function(t){return _.isNumber(t)?this.model?_.filter(this.data,function(e){return e.aid==="#"+t}):this.data[t]:_.isString(t)?this.model?_.pluck(this.parse(),t):_.pluck(this.data,t):_.slice(this.data)},set:function(t){return this.data=_.isArray(t)?t:[t],this.dispatch("set",null,[t])},dispatch:function(t,e,n){return _.dispatch(this,t,_.isFunction(e)?e:null,n)},trigger:function(t,e,n){return this.dispatch(t,e,n)}},_.foreach(["loop","foreach","splice","push","unshift","sort","unique","reject","find","filter","map","cat","groupby","toarray","forarray","pairs","not","hook","bale","pluck","reverse","shuffle","merge","compose"],function(t){aix.model.prototype[t]=_genertor_(t),aix.collection.prototype[t]=_genertor_(t)}),_.foreach(["keys","clone","contain","findindex","has","isequal","requery","typeof","combom"],function(t){aix.model.prototype[t]=_genertor_$(t),aix.collection.prototype[t]=_genertor_$(t)}),_.foreach(["pop","shift"],function(t){aix.model.prototype[t]=_genertor__(t),aix.collection.prototype[t]=_genertor__(t)}),_.extend(aix.model.prototype,{toJSON:function(){return _.isArray(this.data)||_.isObject(this.data)?JSON.stringify(this.data):this.data},parse:function(){return _.clone(this.data)},pipe:function(t,e,n,i,r,o){var a,s,c=this,u={type:RESTFUL_LIST[t.toLowerCase()],aysnc:!0},l=_.isFunction(n);_.isString(e)?(u.url=e,u.param=l?{}:n||{},a=l?n:i||_.NULL,s=l?i||_.NULL:r||_.NULL):_.isObject(e)?(u.url=c.url||"/",u.param=l?e:n||{},a=l?n:i||_.NULL,s=l?i||_.NULL:r||_.NULL):(u.url=c.url||"/",a=_.NULL,s=_.NULL),u.header=o||{},u.success=function(e,n,i){a.call(c,e,n,i),c.dispatch(t+":success",null,[e,n,i])},u.fail=function(e,n){s.call(c,e,n),c.dispatch(t+":fail",null,[e,n])};var h=_.aix(u);return this.dispatch(t,null,[h])},aget:function(t,e,n,i,r){return this.pipe.apply(this,["get",t||this.url||"",e,n,i,r])},fetch:function(t,e,n,i){return this.pipe.apply(this,["fetch",this.url||"",t,function(t,n,i){this.data=JSON.parse(t),(e||_.NULL).call(this,t,n,i)},n,i])},sync:function(){return this.fetch.apply(this,_.slice(arguments))},post:function(t,e,n,i,r){return this.pipe.apply(this,["post",t||this.url||"",e||this.parse(),n,i,r])},save:function(t,e,n){return this.pipe.apply(this,["save",this.url||"",this.parse(),t,e,n])}}),_.extend(aix.collection.prototype,{toJSON:function(){var t=[];return _.foreach(this.data,function(e){t.push(e.get?e.get():e)}),JSON.stringify(t)},parse:function(){return JSON.parse(this.toJSON())},pipe:function(t,e,n,i,r,o){var a,s,c=this,u={type:RESTFUL_LIST[t.toLowerCase()],aysnc:!0},l=_.isFunction(n);_.isString(e)?(u.url=e,u.param=l?{}:n||{},a=l?n:i||_.NULL,s=l?i||_.NULL:r||_.NULL):_.isObject(e)?(u.url=c.url||"/",u.param=l?e:n||{},a=l?n:i||_.NULL,s=l?i||_.NULL:r||_.NULL):(u.url=c.url||"/",a=_.NULL,s=_.NULL),u.header=o||{},u.success=function(e,n,i){a.call(c,e,n,i),c.dispatch(t+":success",null,[e,n,i])},u.fail=function(e,n){s.call(c,e,n),c.dispatch(t+":fail",null,[e,n])};var h=_.aix(u);return this.dispatch(t,null,[h])},aget:function(t,e,n,i,r){return this.pipe.apply(this,["get",t||this.url||"",e,n,i,r])},fetch:function(t,e,n,i){return this.pipe.apply(this,["fetch",this.url||"",t,function(t,n,i){var r=JSON.parse(t);this.model&&_.foreach(r,function(t,e){r[e]=new this.model({data:t})},this),this.data=r,(e||_.NULL).call(this,t,n,i)},n,i])},sync:function(){return this.fetch.apply(this,_.slice(arguments))},post:function(t,e,n,i,r){return this.pipe.apply(this,["post",t||this.url||"",e||this.parse(),n,i,r])},save:function(t,e,n){return this.pipe.apply(this,["save",this.url||"",this.parse(),t,e,n])}}),$=$||_.NULL,aix.view=function(t){if(t=t||{},!_.isString(t.el))return console.error("view must define its 'el' prop bind with elm (custom string)");var e=this;return _.define(e,{vid:{value:"#"+ ++AIX_VIEW_COUNT,writable:!0,enumerable:!1}}),_.isObject(t.events)&&_.foreach(t.events,function(n,i){var r=i.split(":");r.length>1?$(t.el).on(r[0],r[1],{self:this},n):_.addEvent(e,i,n)},this),t.template&&!_.isString(t.template)||(t.template=_.isFunction(t.build)?t.build.call(e,t.template||""):_.doom(t.template||"")),t.render&&_.isFunction(t.render)||(t.render=function(t){return $(this.el).html(this.template(t))&&this}),delete t.change,delete t.events,_.isString(t.url)?(_.aix({url:t.url,cache:!_.isBoolean(t.cache)||t.cache,success:function(n){t.template=_.isFunction(t.build)?t.build.call(e,n):_.doom(n),_.extend(e,_.extend(_.clone(AIX_VIEW_DEFAULT),t)),_.dispatch(e,"init")},fail:function(e){console.error("Fetch template url->["+t.url+"] has fail!"),console.log(e)}}),this):(_.extend(e,_.extend(_.clone(AIX_VIEW_DEFAULT),t)),void _.dispatch(e,"init"))},aix.view.prototype={addEvent:function(t,e){var n=t.split(":");return n.length>1?$(this.el).on(n[0],n[1],{self:this},e):_.addEvent(this,t,e),this},removeEvent:function(t,e){var n=t.split(":");return n.length>1?$(this.el).off(n[0],n[1],e):_.removeEvent(this,t,e),this},empty:function(){return $(this.el).empty(),this},release:function(){return $(this.el).off(),this},destroy:function(t){return $(this.el).off()[t?"remove":"empty"](),_.define(this,"el",{value:null,writable:!1,enumerable:!1,configurable:!1}),_.removeEvent(this)},dispatch:function(t,e,n){return _.dispatch(this,t,_.isFunction(e)?e:null,n)},trigger:function(){return this.dispatch.apply(this,_.slice(arguments))}};var getHash=aix.getHash=function(t){var e=t.search("#");return e>0?t.slice(e+1):""};return aix.route=function(t){t=t||{};var e=this;_.isObject(t.events)&&_.foreach(t.events,function(t,n){_.addEvent(e,n,t)}),delete t.events,_.extend(this,_.extend(_.clone(AIX_ROUTE_DEFAULT),t)),_.addEvent(this,"hashchange",changeHash),_.define(this,{history:{value:{old:"",now:_.root.location.href},writable:!0,enumerable:!1},rid:{value:"aix-route-"+Math.random(),writable:!1,enumerable:!1,configurable:!1},event:{value:function(t){return _.root.location.href===e.history.now?t.preventDefault():(e.history.old=e.history.now,e.history.now=_.root.location.href,_.dispatch(e,"hashchange",null,[getHash(_.root.location.href),getHash(e.history.old),t]))},writable:!1,enumerable:!1,configurable:!1}}),_.dispatch(e,"init")},aix.route.prototype={constructor:aix.route,addEvent:function(t,e){return _.isFunction(e)&&_.addEvent(this,t,e),this},removeEvent:function(t,e){return _.removeEvent(this,t,e)},dispatch:function(t,e,n){return _.dispatch(this,t,e,n)},addRoute:function(t,e){return(_.isString(e)||_.isArray(fnname))&&(this.routes[t]=fnname),this},removeRoute:function(t){return delete this.routes[t],this},addAction:function(t,e){return _.isString(t)&&isFunction(e)&&(this.actions[t]=e),this},removeAction:function(t){return delete this.actions[t],this},listen:function(){return this._listen||(_.define(this,"_listen",{value:1,writable:!1,enumerable:!1,configurable:!0}),_.root.addEventListener("hashchange",this.event),this.dispatch("listen"),this.dispatch("hashchange",null,[getHash(window.location.href)])),this},stop:function(){return delete this._listen&&(_.root.removeEventListener("hashchange",this.event),this.dispatch("stop")),this},assign:function(t){if(this._listen){var e=_.root.location.href,n=e.search("#");n>0&&(e=e.slice(0,n)),_.root.location.href=e+("#"===t.toString().slice(0,1)?"":"#")+t}return this},addhash:function(t){var e=_.root.location.href+(t||"").toString();return e!==_.root.location.href&&(_.root.location.href=e),this}},aix.model.extend=createExtend("model"),aix.collection.extend=createExtend("collection"),aix.view.extend=createExtend("view"),aix.route.extend=createExtend("route"),aix});